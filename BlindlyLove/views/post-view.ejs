<!DOCTYPE html>
<html lang="ko">
<head>
  <title><%= post.title %> | BlindLove</title>
  <link rel="stylesheet" href="/assets/css/signup.css" />
  <%- include('partials/head') %>
  <style>
    /* ğŸ“‘ ëª©ì°¨ ë°•ìŠ¤ ë””ìì¸ */
    .post-content .auto-toc {
      background: #f7f9fa;
      border: 1px solid #d0d7de;
      padding: 1rem;
      margin-bottom: 1rem;
      border-radius: 6px;
      font-size: 0.95rem;
      line-height: 1.4;

      max-width: 280px;       /* ğŸ’¡ ë°•ìŠ¤ ë„ˆë¹„ ì œí•œ */
      width: 100%;            /* ë°˜ì‘í˜• ìœ ì§€ */
      margin-left: 0;      /* ğŸ’¡ ê°€ìš´ë° ì •ë ¬ */
      margin-right: auto;
    }

    .post-content .auto-toc .toc-title {
      font-weight: bold;
      margin-bottom: 0.4rem;
      display: block;
    }

    .post-content .auto-toc ul {
      list-style: none;
      padding: 0;
      margin: 0;
    }

    .post-content .auto-toc li {
      margin: 0.1em 0;
      line-height: 1.2;
      padding-right: 0; 
    }


/* ğŸŒ ë¼ì´íŠ¸ëª¨ë“œ ë§í¬ ë° í˜¸ë²„ íš¨ê³¼ */
.post-content .auto-toc li a {
  color: #0366d6;
  text-decoration: none;
  display: inline-block;        /* âœ… inlineì€ ì¤„ë°”ê¿ˆ ì•ˆë¨. inline-blockìœ¼ë¡œ ë°”ê¿” */
  max-width: 100%;              /* âœ… ë¶€ëª¨ ìš”ì†Œë³´ë‹¤ ë” ë„“ì–´ì§€ì§€ ì•Šê²Œ ì œí•œ */
  width: fit-content;           /* âœ… ê¸€ì ê¸¸ì´ë§Œí¼ë§Œ ì°¨ì§€í•˜ë„ë¡ */
  padding: 2px 6px;
  border-radius: 4px;
  transition: all 0.2s ease;
}

.post-content .auto-toc li a:hover {
  color: #999ff9 !important;
  text-decoration: underline !important;
}




    /* ğŸŒ™ ë‹¤í¬ëª¨ë“œ ë§í¬ ê¸°ë³¸ + hover */
    html.dark .post-content .auto-toc {
      background: #1f1f2b;
      border: 1px solid #444;
      color: #ddd;
    }

    html.dark .post-content .auto-toc li a {
      color: #6fb7ff !important;
    }

    html.dark .post-content .auto-toc li a:hover {
      color: #a2d4ff !important;
      text-decoration: underline;
    }

    /* ì œëª© ê°„ê²© ì¡°ì • */
    .post-content h1,
    .post-content h2 {
      margin-top: 0.8em;
      margin-bottom: 0.4em;
      line-height: 1.3;
    }

    .post-content .auto-toc + h1,
    .post-content .auto-toc + h2 {
      margin-top: 0.5rem !important;
    }

    /* ğŸ“„ ì¼ë°˜ ê¸€ ìŠ¤íƒ€ì¼ */
    .post-title {
      font-size: 1.5rem;
      font-weight: bold;
      text-align: center;
      margin-bottom: 1rem;
    }

    .post-meta {
      text-align: center;
      font-size: 0.9rem;
      color: #777;
      margin-bottom: 2rem;
    }

    .post-content {
      line-height: 1.7;
      font-size: 1rem;
      white-space: pre-wrap;
      color: #333;
      max-width: 640px;
      margin: 0 auto;
      padding-left: 0.5rem;
    }

    html.dark body .post-content {
      color: #ddd;
    }

    .post-actions a.edit-btn,
    .post-actions form button {
      display: inline-block;
      padding: 4px 10px;
      margin: 0 4px;
      border: none;
      border-radius: 6px;
      font-size: 0.75rem;
      font-weight: 500;
      cursor: pointer;
      transition: background 0.2s ease, color 0.2s ease;
    }

    .post-actions a.edit-btn {
      background-color: #f0f8ff;
      color: #0077cc;
      text-decoration: none;
    }

    .post-actions a.edit-btn:hover {
      background-color: #d8edff;
      color: #005fa3;
    }

    .post-actions form button {
      background-color: #fff0f0;
      color: #cc0000;
      border: 1px solid #cc0000;
    }

    .post-actions form button:hover {
      background-color: #ffe5e5;
      color: #a30000;
    }

    .logo-wrap {
      display: flex;
      justify-content: center;
      align-items: center;
    }

    .logo-wrap img {
      max-width: 150px;
      height: auto;
      display: block;
      margin-bottom: 1rem;
    }
  </style>
</head>
<body class="no-fixed-footer">
  <%- include('partials/header') %>

  <div class="signup-container">
    <div class="logo-wrap">
      <img src="/assets/images/post-view.png" alt="BlindLove ë¡œê³ " />
    </div>

    <div class="post-title"><%= post.title %></div>

    <div class="post-meta">
      <span>ì¹´í…Œê³ ë¦¬: <%= post.categories %></span><br>
      <span>ì‘ì„±ì: <%= post.author %></span><br>
      <span>ì‘ì„±ì¼: <%= new Date(post.created_at).toLocaleString() %></span>
    </div>

    <!-- ğŸ“¢ ê´‘ê³  ì‚½ì… -->
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-2585969189290118"
     crossorigin="anonymous"></script>
    <ins class="adsbygoogle"
         style="display:block; text-align:center;"
         data-ad-layout="in-article"
         data-ad-format="fluid"
         data-ad-client="ca-pub-2585969189290118"
         data-ad-slot="3406391330"></ins>
    <script>(adsbygoogle = window.adsbygoogle || []).push({});</script>

    <!-- ğŸ“œ ê²Œì‹œê¸€ ë‚´ìš© -->
    <div class="post-content">
      <%- post.content %>
    </div>

    <!-- âœï¸ ìˆ˜ì • / ì‚­ì œ ë²„íŠ¼ -->
    <% if (user && post.user_id == user.id) { %>
      <div class="post-actions" style="text-align: center; margin-top: 1.5rem;">
        <a href="/edit/<%= post.id %>" class="edit-btn">âœï¸ ìˆ˜ì •í•˜ê¸°</a>
        <form action="/delete/<%= post.id %>" method="POST" style="display: inline;">
          <button type="submit" onclick="return confirm('ì •ë§ ì‚­ì œí•˜ì‹œê² ì–´ìš”?');">ğŸ—‘ ì‚­ì œí•˜ê¸°</button>
        </form>
      </div>
    <% } %>

    <div class="extra" style="margin-top: 2rem; text-align: center;">
      <a href="/" class="back-home-link">â† í™ˆìœ¼ë¡œ ëŒì•„ê°€ê¸°</a>
    </div>
  </div>

<script> 
  document.getElementById("editor").addEventListener("paste", function (e) {
    e.preventDefault();
    const clipboardData = e.clipboardData || window.clipboardData;
    const text = clipboardData.getData("text/plain"); // ìŠ¤íƒ€ì¼ ì—†ëŠ” ìˆœìˆ˜ í…ìŠ¤íŠ¸
    document.execCommand("insertText", false, text);
  });


  document.addEventListener("DOMContentLoaded", () => {
  document.querySelectorAll('.custom-widget[data-type="html-snippet"]').forEach(el => {
    const encoded = el.getAttribute("data-code");
    if (!encoded) return;

    try {
      const decoded = atob(encoded); // ì´ì   escape ì—†ì–´ë„ ë¨

      const iframe = document.createElement('iframe');
      iframe.setAttribute('sandbox', 'allow-scripts allow-same-origin'); // âœ… í•µì‹¬
      iframe.setAttribute('referrerpolicy', 'no-referrer');              // âœ… ë³´ì•ˆ ì•ˆì •
      iframe.setAttribute('title', 'ì‚½ì…ëœ HTML');
      iframe.style.width = '100%';
      iframe.style.minHeight = '400px';
      iframe.style.border = '1px solid #ccc';
      iframe.style.borderRadius = '8px';
      iframe.style.margin = '1rem 0';
      iframe.srcdoc = decoded;

      el.innerHTML = '';
      el.appendChild(iframe);
    } catch (e) {
      el.innerHTML = '<p style="color:red;">[HTML ì½”ë“œ ë””ì½”ë”© ì‹¤íŒ¨]</p>';
      console.error('ë””ì½”ë”© ì˜¤ë¥˜:', e);
    }
  });
});

// âœ… 0.5ì´ˆ í›„ ê°•ì œë¡œ ì‹¤í–‰ (DOM ì™„ì „íˆ ë¡œë“œëœ í›„)
setTimeout(renderHtmlSnippets, 500);


</script>
  <%- include('partials/footer') %>
  <%- include('partials/scripts') %>
</body>
</html>
