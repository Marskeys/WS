<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <title>BlindLove ì—ë””í„°</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" />
  <link href="https://fonts.googleapis.com/css2?family=Nanum+Gothic:wght@400;700&display=swap" rel="stylesheet">
  <style>
    * { box-sizing: border-box; }

    body {
      margin: 0;
      padding: 40px 0;
      background: linear-gradient(135deg, #fff7f0, #ffe4e1);
      font-family: 'Nanum Gothic', sans-serif;
    }

    .save-btn {
  margin-top: 20px;
  background: #62a4eb; /* ì—°í•˜ëŠ˜ íŒŒë‘ */
  color: #333;
  border: none;
  padding: 8px 20px;
  border-radius: 8px;
  font-weight: bold;
  font-size: 14px;
  cursor: pointer;
  margin-right: 10px;
}

.save-btn:hover {
  background: #b8d6fb;
}

    .editor-container {
      background: white;
      border-radius: 16px;
      box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
      padding: 20px;
      width: 90%;
      max-width: 800px;
      margin: 60px auto;
    }

    .logo-wrap {
      text-align: center;
      margin-bottom: 20px;
    }

    .logo-wrap img {
      height: 50px;
      object-fit: contain;
    }

    .title-wrap {
      margin-bottom: 16px;
    }

    .title-wrap input {
      width: 100%;
      padding: 12px 16px;
      font-size: 20px;
      border: 1px solid #ccc;
      border-radius: 12px;
      outline: none;
      background: #fffefc;
      box-shadow: inset 0 1px 3px rgba(0,0,0,0.05);
    }

    .title-wrap input:focus {
      border-color: #ff9990;
      background: #fff7f5;
    }

    .toolbar {
      display: flex;
      flex-wrap: wrap;
      gap: 6px;
      margin-bottom: 12px;
      align-items: center;
    }

    .toolbar button,
    .toolbar input[type="color"] {
      padding: 6px 8px;
      border: 1px solid #ccc;
      border-radius: 8px;
      background: #fff;
      font-size: 14px;
      cursor: pointer;
      transition: all 0.2s ease;
      position: relative;
    }

    .toolbar button[data-tooltip]::after,
    .toolbar input[type="color"][data-tooltip]::after {
      content: attr(data-tooltip);
      position: absolute;
      top: -30px;
      left: 50%;
      transform: translateX(-50%);
      background: #333;
      color: white;
      padding: 4px 8px;
      font-size: 12px;
      white-space: nowrap;
      border-radius: 4px;
      opacity: 0;
      pointer-events: none;
      transition: opacity 0.2s ease;
      z-index: 100;
    }

    .toolbar button[data-tooltip]:hover::after,
    .toolbar input[type="color"][data-tooltip]:hover::after {
      opacity: 1;
    }

    .dropdown {
      position: relative;
    }

    .dropdown-toggle {
  padding: 6px 10px;
  border: 1px solid #ccc;
  background: #fff;
  border-radius: 8px;
  cursor: pointer;
  min-width: 50px; /* í­ ì§€ì • */
  white-space: nowrap; /* ì¤„ë°”ê¿ˆ ë°©ì§€ */
  overflow: hidden;
  text-overflow: ellipsis;
  text-align: right;
}



    .dropdown-menu {
      display: none;
      position: absolute;
      top: 110%;
      left: 0;
      background: #2c2c2c;
      color: white;
      border-radius: 4px;
      overflow: hidden;
      z-index: 1000;
      box-shadow: 0 2px 10px rgba(0,0,0,0.2);
      min-width: 160px; /* ë©”ë‰´ë„ ë„‰ë„‰í•˜ê²Œ */
    }

    .dropdown-menu.show {
      display: block;
    }

    .dropdown-menu div {
      padding: 6px 12px;
      cursor: pointer;
    }

    .dropdown-menu div:hover {
      background: #444;
    }

    .dropdown-menu .h1 { font-size: 24px; font-weight: bold; background: #555; }
    .dropdown-menu .h2 { font-size: 20px; font-weight: bold; background: #444; }
    .dropdown-menu .h3 { font-size: 18px; font-weight: bold; background: #333; }
    .dropdown-menu .red { color: red; font-weight: bold; }
    .dropdown-menu .p { font-size: 16px; }
    .dropdown-menu .desc { font-size: 13px; color: #aaa; font-style: italic; }
    .dropdown-menu .meta { font-size: 12px; color: #bbb; font-style: italic; }
    .dropdown-menu .label { font-size: 12px; background: #888; border-radius: 4px; padding: 2px 6px; display: inline-block; }
    .dropdown-menu .label-bold { font-weight: bold; }

    .editor {
      border: 1px solid #ddd;
      border-radius: 12px;
      min-height: 300px;
      padding: 15px;
      font-size: 16px;
      line-height: 1.6;
      background: #fffefc;
    }

    .editor h1 {
      font-size: 32px;
      font-weight: bold;
      color: #333;
      margin: 16px 0;
    }

    .editor h2 {
      font-size: 26px;
      font-weight: bold;
      color: #444;
      margin: 14px 0;
    }

    .editor h3 {
      font-size: 22px;
      font-weight: bold;
      color: #555;
      margin: 12px 0;
    }

    .editor h4 {
      font-size: 20px;
      font-weight: bold;
      color: red;
      margin: 10px 0;
    }

    .editor p {
      font-size: 16px;
      margin: 8px 0;
      color: #222;
    }

    .editor small {
      font-size: 13px;
      color: #888;
      font-style: italic;
    }

    .editor footer {
      font-size: 12px;
      color: #999;
      font-style: italic;
    }

    .editor span.label {
  font-size: 14px;
  background: #eee;
  padding: 2px 4px;
  border-radius: 4px;
}

    .editor strong {
      font-weight: bold;
      font-size: 14px;
    }

    .category-box {
      margin-top: 30px;
    }

    .category-box label {
      display: block;
      margin-bottom: 6px;
      font-weight: bold;
    }

    .category-list {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
    }

    .category-item {
      position: relative;
      background: #f0f0f0;
      padding: 6px 12px;
      border-radius: 20px;
      font-size: 14px;
      cursor: pointer;
      transition: 0.2s ease;
    }

    .category-item.selected {
      background: #ffd2cc;
      font-weight: bold;
    }

    .category-item:hover {
      background: #ffe4e1;
    }

    .category-item .remove-btn {
      position: absolute;
      top: -6px;
      right: -6px;
      background: #ff6961;
      color: white;
      border: none;
      border-radius: 50%;
      width: 18px;
      height: 18px;
      font-size: 12px;
      display: none;
      cursor: pointer;
    }

    .category-item:hover .remove-btn {
      display: inline-block;
    }

    .add-category-btn {
      margin-top: 12px;
      background: #d0e7ff;
      border: none;
      padding: 6px 14px;
      border-radius: 8px;
      cursor: pointer;
      font-size: 14px;
    }

    .add-category-btn:hover {
      background: #b8d6fb;
    }

    .post-btn {
      margin-top: 20px;
      background: #6cc48f;
      color: white;
      border: none;
      padding: 8px 20px;
      border-radius: 8px;
      font-weight: bold;
      font-size: 14px;
      cursor: pointer;
    }

    .post-btn:hover {
      background: #4fb476;
    }

    .color-palette {
  display: flex;
  gap: 4px;
  margin-left: 8px;
}

.color-palette button {
  width: 20px;
  height: 20px;
  border: 1px solid #aaa;
  border-radius: 4px;
  cursor: pointer;
}


    .toolbar button {
  position: relative;
}

.toolbar button .color-input {
  position: absolute;
  top: 0;
  left: 0;
  opacity: 0;
  width: 100%;
  height: 100%;
  cursor: pointer;
}

#foreColorBtn i {
  color: #000; /* ê¸°ë³¸ê°’ ê²€ì • */
}

#bgColorBtn {
  background-color: #fff; /* ê¸°ë³¸ê°’ í°ìƒ‰ */
}


.color-palette {
  display: flex;
  gap: 4px;
  align-items: center;
  margin-left: 8px;
}

.color-palette button {
  width: 20px;
  height: 20px;
  border: 1px solid #aaa;
  border-radius: 4px;
  cursor: pointer;
  padding: 0;
}

/* "ìƒ‰ ì—†ìŒ" ì•„ì´ì½˜ (í° ë°°ê²½ + ëŒ€ê°ì„  ë¶‰ì€ ì„ ) */
.color-palette .none-icon {
  background: white;
  position: relative;
  overflow: hidden;
}

.color-palette .none-icon::before {
  content: "";
  position: absolute;
  top: 0;
  left: 0;
  width: 200%;
  height: 2px;
  background: red;
  transform: rotate(45deg);
  transform-origin: top left;
}


.color-palette .custom-color {
  display: flex;
  align-items: center;
  font-size: 14px;
  margin-left: 6px;
  cursor: pointer;
  border: 1px solid #aaa;
  border-radius: 4px;
  padding: 0 6px;
  background: white;
}

.color-palette .custom-color input[type="color"] {
  border: none;
  background: transparent;
  width: 24px;
  height: 24px;
  padding: 0;
  margin-left: 4px;
  cursor: pointer;
}


.color-tool {
  position: relative;
  display: inline-block;
}

.color-palette {
  position: absolute;
  top: calc(90% + 2px);  /* ë²„íŠ¼ ë°”ë¡œ ì•„ë˜ì— ë”± ë¶™ì´ê¸° */
  left: 0;
  display: none;
  background: white;
  padding: 4px;
  border: 1px solid #ccc;
  border-radius: 6px;
  box-shadow: 0 4px 10px rgba(0,0,0,0.1);
  z-index: 999;
}

.color-tool:hover .color-palette,
.color-palette:hover {
  display: flex;
}

.color-tool button {
  cursor: pointer;
}



.color-tool:hover .color-palette,
.color-palette:hover {
  display: flex;
}

#foreColorBtn i {
  color: black;
}

#bgColorBtn {
  background-color: white;
}

.color-tool .none-icon {
  background: white;
  position: relative;
  overflow: hidden;
}

.color-tool .none-icon::before {
  content: "";
  position: absolute;
  top: 0;
  left: 0;
  width: 200%;
  height: 2px;
  background: red;
  transform: rotate(45deg);
  transform-origin: top left;
}



    
  </style>
</head>
<body>

  <div class="editor-container">
    <div class="logo-wrap">
      <img src="assets/images/logo.svg" alt="BlindLove ë¡œê³ " />
    </div>

    <div class="title-wrap">
      <input type="text" id="postTitle" placeholder="ì œëª©ì„ ì…ë ¥í•˜ì„¸ìš”" />
    </div>

    <div class="toolbar">
      <div class="dropdown">
        <div class="dropdown-toggle" id="currentStyle" onclick="toggleDropdown()">ë³¸ë¬¸ â–¼</div>
        <div class="dropdown-menu" id="styleDropdown">
          <div class="h1" onclick="applyStyle('h1')">ì œëª©</div>
          <div class="h2" onclick="applyStyle('h2')">ë¶€ì œëª©</div>
          <div class="h3" onclick="applyStyle('h3')">ë¨¸ë¦¬ë§ 1</div>
          <div class="red" onclick="applyStyle('h4')">ë¹¨ê°„ ë¨¸ë¦¬ë§</div>
          <div class="p" onclick="applyStyle('p')">ë³¸ë¬¸</div>
          <div class="desc" onclick="applyStyle('small')">ì„¤ëª…</div>
          <div class="meta" onclick="applyStyle('footer')">ë¨¸ë¦¬ë§ ë° ê¼¬ë¦¬ë§</div>
          <div class="label" onclick="applyStyle('span')">ë ˆì´ë¸”</div>
          <div class="label label-bold" onclick="applyStyle('strong')">ì§„í•œ ë ˆì´ë¸”</div>
        </div>
      </div>

      <button onclick="format('bold')" data-tooltip="êµµê²Œ"><b>B</b></button>
      <button onclick="format('italic')" data-tooltip="ê¸°ìš¸ì´ê¸°"><i>I</i></button>
      <button onclick="format('underline')" data-tooltip="ë°‘ì¤„"><u>U</u></button>
      <button onclick="format('strikeThrough')" data-tooltip="ì·¨ì†Œì„ "><s>S</s></button>
      <button onclick="format('justifyLeft')" data-tooltip="ì™¼ìª½ ì •ë ¬"><i class="fas fa-align-left"></i></button>
      <button onclick="format('justifyCenter')" data-tooltip="ê°€ìš´ë° ì •ë ¬"><i class="fas fa-align-center"></i></button>
      <button onclick="format('justifyRight')" data-tooltip="ì˜¤ë¥¸ìª½ ì •ë ¬"><i class="fas fa-align-right"></i></button>
      <button onclick="format('insertOrderedList')" data-tooltip="ë²ˆí˜¸ ëª©ë¡"><i class="fas fa-list-ol"></i></button>
      <button onclick="format('insertUnorderedList')" data-tooltip="ê¸€ë¨¸ë¦¬ ê¸°í˜¸"><i class="fas fa-list-ul"></i></button>
      <button onclick="format('outdent')" data-tooltip="ë‚´ì–´ì“°ê¸°"><i class="fas fa-outdent"></i></button>
      <button onclick="format('indent')" data-tooltip="ë“¤ì—¬ì“°ê¸°"><i class="fas fa-indent"></i></button>
      <button onclick="format('createLink')" data-tooltip="ë§í¬ ì‚½ì…"><i class="fas fa-link"></i></button>
      <button onclick="format('unlink')" data-tooltip="ë§í¬ ì œê±°"><i class="fas fa-unlink"></i></button>
     
      <div class="color-tool" id="foreTool">
        <button id="foreColorBtn" data-tooltip="ê¸€ì ìƒ‰ìƒ" onmousedown="saveSelection()">
          <i class="fas fa-pencil-alt" id="foreIcon"></i>
        </button>
        <div class="color-palette" id="forePalette">
          <button style="background:black" onclick="setColor('foreColor', 'black')"></button>
          <button style="background:red" onclick="setColor('foreColor', 'red')"></button>
          <button style="background:orange" onclick="setColor('foreColor', 'orange')"></button>
          <button style="background:green" onclick="setColor('foreColor', 'green')"></button>
          <button style="background:blue" onclick="setColor('foreColor', 'blue')"></button>
          <button class="none-icon" onclick="setColor('foreColor', '__clear__')" title="ìƒ‰ ì—†ìŒ"></button>
          <label class="custom-color">
            ğŸ¨<input type="color" onchange="setColor('foreColor', this.value)" />
          </label>
        </div>
      </div>
      
      <div class="color-tool" id="bgTool">
        <button id="bgColorBtn" data-tooltip="ë°°ê²½ ìƒ‰ìƒ" onmousedown="saveSelection()">
          <i class="fas fa-fill-drip" id="bgIcon"></i>
        </button>
        <div class="color-palette" id="bgPalette">
          <button style="background:yellow" onclick="setColor('hiliteColor', 'yellow')"></button>
          <button style="background:lightblue" onclick="setColor('hiliteColor', 'lightblue')"></button>
          <button style="background:lightgreen" onclick="setColor('hiliteColor', 'lightgreen')"></button>
          <button style="background:pink" onclick="setColor('hiliteColor', 'pink')"></button>
          <button style="background:#ccc" onclick="setColor('hiliteColor', '#ccc')"></button>
          <button class="none-icon" onclick="setColor('hiliteColor', '__clear__')" title="ìƒ‰ ì—†ìŒ"></button>
          <label class="custom-color">
            ğŸ¨<input type="color" onchange="setColor('hiliteColor', this.value)" />
          </label>
        </div>
      </div>

      
      

      <button onclick="insertImage()" data-tooltip="ì´ë¯¸ì§€ ì‚½ì…"><i class="fas fa-image"></i></button>
      <button onclick="format('removeFormat')" data-tooltip="í˜•ì‹ ì œê±°">ì§€ìš°ê¸°</button>
    </div>

    <div id="editor" contenteditable="true" class="editor" spellcheck="false">
      <p><br></p>
    </div>

    <div class="category-box">
      <label>ì¹´í…Œê³ ë¦¬:</label>
      <div class="category-list" id="categoryList"></div>
      <button class="add-category-btn" onclick="addCategory()">â• ì¹´í…Œê³ ë¦¬ ì¶”ê°€</button>
      <button class="post-btn" onclick="postContent()">ğŸ“¬ í¬ìŠ¤íŒ…</button>
      <button class="save-btn" onclick="saveContent()">ğŸ’¾ ì €ì¥</button>
    </div>
  </div>

  <script>
    let categories = ['ì¼ìƒ', 'ê¸°ë¡', 'ë¦¬ë·°'];
    let selectedCategories = ['ì¼ìƒ'];
    let savedRange = null; // ì „ì—­ ë³€ìˆ˜ë¡œ savedRange ìœ ì§€

    function renderCategories() {
        const list = document.getElementById('categoryList');
        list.innerHTML = '';
        categories.forEach((cat, index) => {
            const item = document.createElement('div');
            item.className = 'category-item';
            if (selectedCategories.includes(cat)) item.classList.add('selected');
            item.innerText = cat;
            item.onclick = () => {
                const i = selectedCategories.indexOf(cat);
                if (i === -1) selectedCategories.push(cat);
                else selectedCategories.splice(i, 1);
                renderCategories();
            };
            const removeBtn = document.createElement('button');
            removeBtn.className = 'remove-btn';
            removeBtn.innerText = 'Ã—';
            removeBtn.onclick = (e) => {
                e.stopPropagation();
                if (confirm(`'${cat}' ì¹´í…Œê³ ë¦¬ë¥¼ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?`)) {
                    categories.splice(index, 1);
                    selectedCategories = selectedCategories.filter(c => c !== cat);
                    renderCategories();
                }
            };
            item.appendChild(removeBtn);
            list.appendChild(item);
        });
    }

    function addCategory() {
        const newCat = prompt("ì¶”ê°€í•  ì¹´í…Œê³ ë¦¬ ì´ë¦„ì„ ì…ë ¥í•˜ì„¸ìš”:");
        if (newCat && !categories.includes(newCat)) {
            categories.push(newCat);
            selectedCategories.push(newCat);
            renderCategories();
        }
    }

    function postContent() {
        const title = document.getElementById('postTitle').value.trim();
        const content = document.getElementById('editor').innerHTML;
        if (!title) return alert("ì œëª©ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.");
        if (selectedCategories.length === 0) return alert("ìµœì†Œ í•˜ë‚˜ì˜ ì¹´í…Œê³ ë¦¬ë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”.");
        alert(`í¬ìŠ¤íŒ…ë¨!\nì œëª©: ${title}\nì¹´í…Œê³ ë¦¬: ${selectedCategories.join(', ')}`);
    }

    // --- ìˆ˜ì •ëœ format í•¨ìˆ˜ ---
    // ëª¨ë“  execCommandëŠ” ê¸°ë³¸ì ìœ¼ë¡œ styleWithCSS=falseë¡œ ì‘ë™í•˜ë©°,
    // íƒœê·¸ ê¸°ë°˜ìœ¼ë¡œ ìš”ì†Œë¥¼ ìƒì„±í•©ë‹ˆë‹¤ (<b>, <i>, <u> ë“±).
    function format(command, value = null) {
        document.execCommand("styleWithCSS", false, false); // í•­ìƒ CSS ì‚¬ìš© ì•ˆí•¨
        document.execCommand(command, false, value);
        // execCommand í›„ì—ëŠ” detectStyleì„ í˜¸ì¶œí•˜ì—¬ í˜„ì¬ ìŠ¤íƒ€ì¼ì„ ì—…ë°ì´íŠ¸í•©ë‹ˆë‹¤.
        setTimeout(detectStyle, 100);
    }
    // -------------------------

    // --- ìˆ˜ì •ëœ applyStyle í•¨ìˆ˜ ---
    // ì´ í•¨ìˆ˜ëŠ” ë¸”ë¡ ë ˆë²¨ ìš”ì†Œ (h1, p ë“±) ìƒì„±ì— ì§‘ì¤‘í•©ë‹ˆë‹¤.
    // span/strong ê°™ì€ ì¸ë¼ì¸ ìš”ì†ŒëŠ” format í•¨ìˆ˜ë‚˜ setColor í•¨ìˆ˜ì—ì„œ ì²˜ë¦¬ë˜ë„ë¡ í•©ë‹ˆë‹¤.
    function applyStyle(tag) {
  const blockTags = ['h1', 'h2', 'h3', 'h4', 'p', 'small', 'footer'];
  const editor = document.getElementById("editor");

  // ì„ íƒ ì˜ì—­ ì €ì¥ í›„ ë³µì›
  restoreSelection();
  editor.focus();

  if (blockTags.includes(tag)) {
    document.execCommand("styleWithCSS", false, false);
    document.execCommand('formatBlock', false, `<${tag.toUpperCase()}>`);

    // ë‹¤ì‹œ ì„ íƒ ì˜ì—­ì„ ì €ì¥í•´ì„œ ì»¤ì„œ ì´ë™ ë°©ì§€
    saveSelection();
  } else {
    const sel = window.getSelection();
    if (!sel.rangeCount || sel.isCollapsed) return;

    const range = sel.getRangeAt(0);
    const tempElement = document.createElement(tag);
    if (tag === 'span') tempElement.classList.add('label');
    if (tag === 'strong') tempElement.classList.add('label', 'label-bold');

    try {
      const contents = range.extractContents();
      tempElement.appendChild(contents);
      range.insertNode(tempElement);

      // ì„ íƒ ì˜ì—­ ë‹¤ì‹œ ì§€ì •
      sel.removeAllRanges();
      const newRange = document.createRange();
      newRange.selectNode(tempElement);
      sel.addRange(newRange);

      saveSelection();
    } catch (e) {
      console.error("applyStyle(span/strong) ì˜¤ë¥˜:", e);
    }
  }

  setTimeout(detectStyle, 100);
}

    // -------------------------

    function insertImage() {
        const url = prompt("ì´ë¯¸ì§€ URLì„ ì…ë ¥í•˜ì„¸ìš”:");
        if (url) format('insertImage', url);
    }

    function saveContent() {
        const content = document.getElementById('editor').innerHTML;
        alert("ì„ì‹œ ì €ì¥ ì™„ë£Œ!");
    }

    function toggleDropdown() {
        document.getElementById('styleDropdown').classList.toggle('show');
    }

    function updateCurrentStyle(tagName) {
        const labelMap = {
            h1: "ì œëª©",
            h2: "ë¶€ì œëª©",
            h3: "ë¨¸ë¦¬ë§ 1",
            h4: "ë¹¨ê°„ ë¨¸ë¦¬ë§",
            p: "ë³¸ë¬¸",
            small: "ì„¤ëª…",
            footer: "ë¨¸ë¦¬ë§ ë° ê¼¬ë¦¬ë§",
            span: "ë ˆì´ë¸”",
            strong: "ì§„í•œ ë ˆì´ë¸”"
        };
        const label = labelMap[tagName.toLowerCase()] || tagName;
        document.getElementById("currentStyle").innerText = `${label} â–¼`;
    }

    function detectStyle() {
  const sel = window.getSelection();
  if (!sel.rangeCount) return;
  let node = sel.getRangeAt(0).startContainer;

  // í…ìŠ¤íŠ¸ ë…¸ë“œë©´ ë¶€ëª¨ë¡œ ì´ë™
  if (node.nodeType === 3) node = node.parentNode;

  // ê°€ì¥ ê°€ê¹Œìš´ ë¸”ë¡ ìš”ì†Œ íƒìƒ‰
  while (node && node !== document) {
    const tag = node.tagName?.toLowerCase();
    if (['h1', 'h2', 'h3', 'h4', 'p', 'small', 'footer'].includes(tag)) {
      updateCurrentStyle(tag);
      return;
    }
    node = node.parentNode;
  }

  // ëª» ì°¾ìœ¼ë©´ ê¸°ë³¸ ë³¸ë¬¸
  updateCurrentStyle('p');
}



    function saveSelection() {
        const sel = window.getSelection();
        if (sel.rangeCount > 0) {
            savedRange = sel.getRangeAt(0).cloneRange(); // Range ê°ì²´ ë³µì‚¬ë³¸ ì €ì¥
        }
    }

    function restoreSelection() {
        const sel = window.getSelection();
        if (savedRange) {
            sel.removeAllRanges();
            sel.addRange(savedRange);
        }
    }

    // --- ìˆ˜ì •ëœ setColor í•¨ìˆ˜ ---
    // execCommand('foreColor')ì™€ 'hiliteColor'ëŠ” styleWithCSSë¥¼ ëª…ì‹œì ìœ¼ë¡œ trueë¡œ ì„¤ì •í•˜ì—¬
    // ì¸ë¼ì¸ ìŠ¤íƒ€ì¼ì„ ì ìš©í•˜ê³ , ì™„ë£Œ í›„ ë‹¤ì‹œ falseë¡œ ë˜ëŒë¦½ë‹ˆë‹¤.
    function setColor(command, color) {
  restoreSelection();
  const sel = window.getSelection();
  if (!sel.rangeCount || sel.isCollapsed) return;

  const range = sel.getRangeAt(0);

  // "ìƒ‰ ì—†ìŒ" ì²˜ë¦¬
  if (color === "__clear__") {
    // ì„ íƒ ì˜ì—­ ë‚´ spanì— ì ìš©ëœ ìŠ¤íƒ€ì¼ ì œê±°
    const contents = range.cloneContents();
    const spans = contents.querySelectorAll("span");

    spans.forEach(span => {
      if (command === 'foreColor') span.style.color = '';
      else if (command === 'hiliteColor') span.style.backgroundColor = '';
    });

    range.deleteContents();
    range.insertNode(contents);
    return;
  }

  // í…ìŠ¤íŠ¸ ì„ íƒ ë¶€ë¶„ì„ spanìœ¼ë¡œ ê°ì‹¸ê³  ìŠ¤íƒ€ì¼ ì ìš©
  const span = document.createElement("span");
  if (command === "foreColor") span.style.color = color;
  else if (command === "hiliteColor") span.style.backgroundColor = color;

  const contents = range.extractContents();
  span.appendChild(contents);
  range.insertNode(span);

  // ì„ íƒ ì˜ì—­ ë‹¤ì‹œ ì„¤ì • (ì»¤ì„œê°€ ë°–ìœ¼ë¡œ íŠ€ëŠ” ë¬¸ì œ ë°©ì§€)
  sel.removeAllRanges();
  const newRange = document.createRange();
  newRange.selectNode(span);
  sel.addRange(newRange);

  saveSelection();
  detectStyle();
}



function getCurrentBlockTag() {
  const sel = window.getSelection();
  if (!sel.rangeCount) return null;

  let node = sel.getRangeAt(0).startContainer;
  while (node && node !== document) {
    if (node.nodeType === 1) {
      const tag = node.tagName.toLowerCase();
      if (['h1', 'h2', 'h3', 'h4', 'p', 'small', 'footer'].includes(tag)) {
        return tag;
      }
    }
    node = node.parentNode;
  }

  return 'p';
}



    // -------------------------

    window.onclick = function(e) {
        if (!e.target.matches('.dropdown-toggle')) {
            const dropdowns = document.getElementsByClassName('dropdown-menu');
            for (let d of dropdowns) d.classList.remove('show');
        }
    };

    window.onload = () => {
        renderCategories();
        // ì—ë””í„° ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ
        const editor = document.getElementById('editor');
        editor.addEventListener('keyup', detectStyle);
        editor.addEventListener('mouseup', detectStyle);
        editor.addEventListener('mouseup', saveSelection);
        editor.addEventListener('keyup', saveSelection);

        // íˆ´ë°” ë²„íŠ¼ë“¤ì— mousedown ì´ë²¤íŠ¸ ì¶”ê°€ (í´ë¦­ ì‹œ ì„ íƒ ì˜ì—­ ìœ ì‹¤ ë°©ì§€)
        const toolbarButtons = document.querySelectorAll('.toolbar button, .dropdown-toggle');
        toolbarButtons.forEach(button => {
            button.addEventListener('mousedown', saveSelection);
        });
    };
</script>
</body>
</html>

