<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ê·€ì—¬ìš´ ìŒí–¥í•™ ì„œë¬¸</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css" />
  <style>
    /* =========================================================
       Fonts: Pretendard í°íŠ¸ ì‹œìŠ¤í…œ ì ìš©
       ========================================================= */
    /* âœ… Pretendard Variable: ëª¨ë“  êµµê¸° í¬í•¨ + font-display: swap */
    @import url('https://cdn.jsdelivr.net/gh/orioncactus/pretendard/dist/web/variable/pretendardvariable.css');
    
    /* âœ… ì¼ë³¸ì–´/ì¤‘êµ­ì–´(Simple) í´ë°± ìœ ì§€ */
    @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@300;400;500;700;900&display=swap');
    @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+SC:wght@300;400;500;700;900&display=swap');

    /* ===== Global font family ===== */
    :root{
      /* ë©”ì¸: Pretendard â†’ ì‹¤íŒ¨ ì‹œ KR í´ë°± ìˆœì„œ */
      --font-sans: "Pretendard Variable", "Pretendard",
                   -apple-system, system-ui, "Segoe UI", Roboto, "Helvetica Neue", Arial,
                   "Noto Sans KR", "Noto Sans", sans-serif;
      --tracking-body: -0.003em;
      --lh-body:        1.55;
      --lh-heading:     1.25;
    }

    body {
      margin: 0;
      /* í°íŠ¸ ì ìš© */
      font-family: var(--font-sans);
      letter-spacing: var(--tracking-body);
      line-height: var(--lh-body);
      background: #f5f5f5;
      overflow: hidden; 
      transition: background 0.3s, color 0.3s;
      /* í—¤ë” ê³µê°„ í™•ë³´ë¥¼ ìœ„í•´ viewer ìœ„ì¹˜ ì¡°ì • */
      display: flex;
      flex-direction: column;
      height: 100vh;
    }
    
    /* ğŸ‡°ğŸ‡· í•œêµ­ì–´ í˜ì´ì§€ì—ì„œ 'ì´ˆë¯¸ì„¸' ìê°„ */
    :lang(ko), .lang-ko {
      letter-spacing: -0.0020em;
    }

    body.dark {
      background: #121212;
      color: #f5f5f5;
    }
    
    /* =========================================================
       í—¤ë” ìŠ¤íƒ€ì¼ (ì¶”ê°€)
       ========================================================= */
    .app-header {
        width: 100%;
        height: 50px; /* í—¤ë” ë†’ì´ ì„¤ì • */
        background: #000; /* ê²€ì€ìƒ‰ ë°°ê²½ */
        color: white;
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 0 20px;
        box-sizing: border-box;
        position: relative;
        z-index: 50; /* í˜ì´ì§€ë³´ë‹¤ ìœ„ì— ìˆë„ë¡ ì„¤ì • */
    }
    
    .header-title {
        font-size: 18px;
        font-weight: 600;
        margin-left: 10px;
        letter-spacing: -0.01em;
    }
    
    .header-controls {
        display: flex;
        gap: 10px; /* ë²„íŠ¼ ê°„ ê°„ê²© */
    }
    
    /* =========================================================
       ë·°ì–´ ë° ë²„íŠ¼ ìŠ¤íƒ€ì¼ (ìˆ˜ì •/ì¬ë°°ì¹˜)
       ========================================================= */

    .viewer {
      position: relative;
      width: 100%;
      /* ë·°ì–´ê°€ ë‚˜ë¨¸ì§€ ë†’ì´ë¥¼ ëª¨ë‘ ì°¨ì§€í•˜ë„ë¡ ì„¤ì • */
      flex: 1; 
      display: flex;
      justify-content: center;
      align-items: center;
      overflow: hidden; /* ëª©ì°¨ ìˆ¨ê¹€ì„ ìœ„í•´ í•„ìˆ˜ */
    }

    .page {
      /* í—¤ë” ê³µê°„ í™•ë³´ë¡œ ì¸í•´ ë†’ì´ ì¡°ì • í•„ìš” */
      width: 80%;
      max-width: 800px;
      height: calc(100vh - 100px); /* ë·°ì–´ ë†’ì´ì— ë§ê²Œ ì¡°ì • */
      background: white;
      border-radius: 16px;
      padding: 40px;
      box-shadow: 0 4px 20px rgba(0, 0, 0, 0.15);
      overflow: hidden;
      line-height: 1.8;
      font-size: 16px;
      display: flex;
      flex-direction: column;
      justify-content: space-between;
    }

    body.dark .page {
      background: #333;
      color: #f5f5f5;
      box-shadow: 0 4px 20px rgba(0, 0, 0, 0.4);
    }
    
    /* í—¤ë” ë‚´ ë²„íŠ¼ ìŠ¤íƒ€ì¼ */
    .header-btn {
        background: none;
        color: white;
        border: 1px solid #444; /* í…Œë‘ë¦¬ ì¶”ê°€ */
        border-radius: 4px;
        padding: 8px 10px;
        cursor: pointer;
        font-size: 14px;
        font-weight: 500;
        transition: background 0.2s, border-color 0.2s;
        display: flex;
        align-items: center;
        gap: 5px;
    }
    
    .header-btn i {
        font-size: 16px;
    }

    .header-btn:hover {
        background: #222;
        border-color: #666;
    }
    
    /* ë„¤ë¹„ê²Œì´ì…˜ ë²„íŠ¼ (ì¢Œìš° í™”ì‚´í‘œ)ì€ ê¸°ì¡´ ìœ„ì¹˜ ìœ ì§€ */
    .nav-btn {
      position: absolute;
      top: 50%;
      transform: translateY(-50%);
      background: rgba(51, 51, 51, 0.8);
      color: white;
      border: none;
      border-radius: 50%;
      width: 40px;
      height: 40px;
      font-size: 18px;
      cursor: pointer;
      opacity: 0.7;
      transition: opacity 0.3s, background 0.3s;
      z-index: 10;
    }
    
    body.dark .nav-btn {
        background: rgba(85, 85, 85, 0.8);
    }

    #prevBtn { left: 10px; }
    #nextBtn { right: 10px; }

    /* ëª©ì°¨ íŒ¨ë„ ìŠ¤íƒ€ì¼ì€ ìœ ì§€ */
    .toc {
      position: absolute;
      top: 0;
      right: -300px; 
      width: 300px;
      height: 100%;
      background: #222;
      color: white;
      transition: right 0.3s ease;
      overflow-y: auto;
      padding: 20px;
      z-index: 20;
    }

    .toc.open {
      right: 0;
    }
    
    /* ë¯¸ë””ì–´ ì¿¼ë¦¬ ì¡°ì • */
    @media (max-width: 768px) {
      .app-header {
        padding: 0 10px;
      }
      .header-title {
        font-size: 16px;
      }
      .page {
        width: 95%;
        padding: 20px;
        height: calc(100vh - 80px); /* ëª¨ë°”ì¼ í—¤ë” ë†’ì´ì— ë§ê²Œ ì¡°ì • */
      }
      .header-btn {
        padding: 6px 8px;
      }
    }
  </style>
</head>
<body>
    
  <header class="app-header">
      <div class="header-title">ê·€ì—¬ìš´ ìŒí–¥í•™ ì„œë¬¸</div>
      <div class="header-controls">
          <button id="homeBtn" class="header-btn" title="í™ˆìœ¼ë¡œ ì´ë™">
              <i class="fas fa-home"></i> í™ˆ
          </button>
          
          <button id="darkModeToggle" class="header-btn" title="í…Œë§ˆ ì „í™˜">
              <i class="fas fa-moon"></i> 
              <span id="darkModeLabel">ë‹¤í¬ ëª¨ë“œ</span>
          </button>
          
          <button id="tocToggle" class="header-btn" title="ëª©ì°¨ ë³´ê¸°">
              <i class="fas fa-list"></i> ëª©ì°¨
          </button>
      </div>
  </header>

  <div class="viewer">
    <button id="prevBtn" class="nav-btn">ã€ˆ</button>
    <button id="nextBtn" class="nav-btn">ã€‰</button>

    <div class="page" id="page">
      <div class="page-text" id="pageText"></div>
      <div class="page-index" id="pageIndex"></div>
    </div>

    <div class="toc" id="toc">
      <h3>ëª©ì°¨</h3>
      <ul id="tocList"></ul>
    </div>
  </div>

  <script>
    const book = {
      title: "ê·€ì—¬ìš´ ìŒí–¥í•™ ì„œë¬¸",
      subtitle: "(ì¼ëŸ¬ìŠ¤íŠ¸: ìš°ë¦¬ ìŒí–¥í•™ì€ ì•ˆ ë¬¼ì–´ìš”!)",
      body: `â€˜ì†Œë¦¬â€™ëŠ” ê³µê¸°ì˜ ë¯¸ì„¸í•œ ì§„ë™ì„ ê·€ë¡œ ê°ì§€í•œ ê²ƒì„ ë§í•©ë‹ˆë‹¤. ë„“ì€ ì˜ë¯¸ì—ì„œëŠ” ê·€ë¡œ ë“¤ì„ ìˆ˜ ì—†ëŠ” ìˆœìˆ˜í•œ ì§„ë™ ìì²´ë„ ì†Œë¦¬ì˜ ë²”ì£¼ì— ë„£ê¸°ë„ í•©ë‹ˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´, â€˜ì´ˆìŒíŒŒâ€™ëŠ” ê·¸ ì§„ë™ì´ ë„ˆë¬´ ë¹¨ë¼ ì¸ê°„ì˜ ê·€ë¡œëŠ” ìŒì˜ ë†’ë‚®ì´ë¥¼ ì¸ì‹í•  ìˆ˜ ì—†ì§€ë§Œ, ê³µê°„ì„ í†µí•´ í¼ì ¸ë‚˜ê°€ëŠ” ë¬¼ë¦¬ì ì¸ ì§„ë™ì´ë¼ëŠ” ë³¸ì§ˆì ì¸ íŠ¹ì„±ì€ ì¼ë°˜ì ì¸ ì†Œë¦¬ì™€ ì •í™•íˆ ê°™ê¸° ë•Œë¬¸ì— ì†Œë¦¬ì˜ ì¼ì¢…ìœ¼ë¡œ ë´…ë‹ˆë‹¤. ì´ëŠ” ë§ˆì¹˜ ìì™¸ì„ ì´ë‚˜ ì ì™¸ì„ ì„ ìš°ë¦¬ê°€ ëˆˆìœ¼ë¡œ ë³¼ ìˆ˜ëŠ” ì—†ì§€ë§Œ, ì—¬ì „íˆ ê³µê°„ì„ í¼ì ¸ë‚˜ê°€ëŠ” ì „ìê¸°ì ì¸ ì§„ë™ì´ë¼ëŠ” ì¸¡ë©´ì—ì„œ ë¹¨ì£¼ë…¸ì´ˆíŒŒë‚¨ë³´ì˜ ê°€ì‹œê´‘ì„ ê³¼ ê°™ì€ â€˜ë¹›â€™ìœ¼ë¡œ ì·¨ê¸‰í•˜ëŠ” ê²ƒê³¼ë„ ê°™ìŠµë‹ˆë‹¤.

ëˆˆìœ¼ë¡œ ë³¼ ìˆ˜ ìˆëŠ” íŒŒì¥ ë²”ìœ„ì˜ ë¹›ì„ ê°€ì‹œê´‘ì„ (visible light)ì´ë¼ê³  ë¶€ë¥´ë“¯, ê·€ë¡œ ë“¤ì„ ìˆ˜ ìˆëŠ” ì£¼íŒŒìˆ˜ ë²”ìœ„ì˜ ì†Œë¦¬ë¥¼ ê°€ì²­ìŒ(audible sound)ì´ë¼ê³  í•©ë‹ˆë‹¤. ì¸ê°„ì˜ ê°ê°ê¸°ê´€ì´ ì¸ì§€í•  ìˆ˜ ìˆëŠ” ì™¸ë¶€ ìê·¹ì€ ì‹¤ì œë¡œ ì¡´ì¬í•˜ëŠ” ìê·¹ì˜ ê·¹íˆ ì¼ë¶€ì— ë¶ˆê³¼í•©ë‹ˆë‹¤.`
    };

    const charsPerPage = 1200; // í•œ í˜ì´ì§€ë‹¹ ê¸€ì ìˆ˜
    const pages = [];
    for (let i = 0; i < book.body.length; i += charsPerPage) {
      pages.push(book.body.slice(i, i + charsPerPage));
    }

    let currentPage = 0;
    const pageText = document.getElementById("pageText");
    const pageIndex = document.getElementById("pageIndex");
    const tocEl = document.getElementById("toc");
    const bodyEl = document.body;
    const darkModeToggle = document.getElementById("darkModeToggle");
    const darkModeIcon = darkModeToggle.querySelector('i'); // ì•„ì´ì½˜ ìš”ì†Œ ì„ íƒ
    const darkModeLabel = document.getElementById("darkModeLabel"); // í…ìŠ¤íŠ¸ ë¼ë²¨ ì„ íƒ
    
    // ë¡œì»¬ ì €ì¥ì†Œì—ì„œ ì„¤ì • ë¶ˆëŸ¬ì˜¤ê¸°
    const initialDarkMode = localStorage.getItem('darkMode') === 'true';

    // ë‹¤í¬ ëª¨ë“œ ìƒíƒœë¥¼ ì„¤ì •í•˜ê³  ë²„íŠ¼ ì•„ì´ì½˜ ë° í…ìŠ¤íŠ¸ë¥¼ ì—…ë°ì´íŠ¸í•˜ëŠ” í•¨ìˆ˜
    function setDarkMode(isDark) {
        if (isDark) {
            bodyEl.classList.add("dark");
            // ë‹¬ ì•„ì´ì½˜ -> í•´ ì•„ì´ì½˜ìœ¼ë¡œ ë³€ê²½
            darkModeIcon.classList.remove("fa-moon");
            darkModeIcon.classList.add("fa-sun");
            darkModeLabel.innerText = "ë¼ì´íŠ¸ ëª¨ë“œ";
            localStorage.setItem('darkMode', 'true');
        } else {
            bodyEl.classList.remove("dark");
            // í•´ ì•„ì´ì½˜ -> ë‹¬ ì•„ì´ì½˜ìœ¼ë¡œ ë³€ê²½
            darkModeIcon.classList.remove("fa-sun");
            darkModeIcon.classList.add("fa-moon");
            darkModeLabel.innerText = "ë‹¤í¬ ëª¨ë“œ";
            localStorage.setItem('darkMode', 'false');
        }
    }
    
    // ì´ˆê¸° ëª¨ë“œ ì„¤ì • 
    setDarkMode(initialDarkMode);

    function renderPage() {
      const header = `<h1>${book.title}</h1><h2>${book.subtitle}</h2>`;
      pageText.innerHTML = header + "<p>" + pages[currentPage] + "</p>";
      pageIndex.innerText = `${currentPage + 1} / ${pages.length}`;
    }

    function renderTOC() {
      const tocList = document.getElementById("tocList");
      tocList.innerHTML = `<li onclick="goTo(0)">ê·€ì—¬ìš´ ìŒí–¥í•™ ì„œë¬¸</li>`;
    }

    function goTo(i) {
      currentPage = i;
      renderPage();
      tocEl.classList.remove("open");
    }

    document.getElementById("nextBtn").onclick = () => {
      if (currentPage < pages.length - 1) {
        currentPage++;
        renderPage();
      }
    };
    document.getElementById("prevBtn").onclick = () => {
      if (currentPage > 0) {
        currentPage--;
        renderPage();
      }
    };
    document.getElementById("tocToggle").onclick = () => {
      tocEl.classList.toggle("open");
    };
    document.getElementById("homeBtn").onclick = () => {
      window.location.href = "/"; // í™ˆìœ¼ë¡œ ì´ë™
    };
    
    // ë‹¤í¬ ëª¨ë“œ í† ê¸€ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ
    darkModeToggle.onclick = () => {
        const isDark = !bodyEl.classList.contains("dark");
        setDarkMode(isDark);
    };

    renderTOC();
    renderPage();

    // ëª¨ë°”ì¼ì—ì„œ ìŠ¬ë¼ì´ë“œë¡œ í˜ì´ì§€ ë„˜ì–´ê°€ê¸°
    let touchStartX = 0;
    let touchEndX = 0;
    
    document.body.addEventListener("touchstart", (e) => {
      touchStartX = e.changedTouches[0].screenX;
    });
    
    document.body.addEventListener("touchend", (e) => {
      touchEndX = e.changedTouches[0].screenX;
      if (touchStartX - touchEndX > 50) {
        if (currentPage < pages.length - 1) {
          currentPage++;
          renderPage();
        }
      } else if (touchEndX - touchStartX > 50) {
        if (currentPage > 0) {
          currentPage--;
          renderPage();
        }
      }
    });
  </script>

</body>
</html>