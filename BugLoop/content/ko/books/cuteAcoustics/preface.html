<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ê·€ì—¬ìš´ ìŒí–¥í•™ ì„œë¬¸</title>
  <style>
    body {
      margin: 0;
      font-family: "Noto Serif KR", serif;
      background: #f5f5f5;
      overflow: hidden; /* ìŠ¤í¬ë¡¤ ì™„ì „ ê¸ˆì§€ */
      transition: background 0.3s, color 0.3s; /* ë‹¤í¬ëª¨ë“œ ì „í™˜ ì‹œ ë¶€ë“œëŸ½ê²Œ */
    }

    body.dark {
      background: #121212;
      color: #f5f5f5;
    }

    .viewer {
      position: relative;
      width: 100%;
      height: 100vh;
      display: flex;
      justify-content: center;
      align-items: center;
    }

    .page {
      width: 80%;
      max-width: 800px;
      height: 90vh;
      background: white;
      border-radius: 16px;
      padding: 40px;
      box-shadow: 0 4px 20px rgba(0, 0, 0, 0.15);
      overflow: hidden;
      line-height: 1.8;
      font-size: 16px;
      display: flex;
      flex-direction: column;
      justify-content: space-between;
    }

    body.dark .page {
      background: #333;
      color: #f5f5f5;
      box-shadow: 0 4px 20px rgba(0, 0, 0, 0.4);
    }

    h1 {
      font-size: 28px;
      margin-bottom: 10px;
    }

    h2 {
      font-size: 20px;
      color: #666;
      margin-top: 0;
    }
    
    body.dark h2 {
      color: #bbb;
    }

    .page-text {
      flex: 1;
      overflow: hidden;
      white-space: pre-wrap;
    }

    .page-index {
      text-align: right;
      color: #aaa;
      font-size: 14px;
    }

    .nav-btn {
      position: absolute;
      top: 50%;
      transform: translateY(-50%);
      background: #333;
      color: white;
      border: none;
      border-radius: 50%;
      width: 48px;
      height: 48px;
      font-size: 22px;
      cursor: pointer;
      opacity: 0.7;
      transition: opacity 0.3s, background 0.3s;
      z-index: 10;
    }
    
    body.dark .nav-btn {
        background: #555;
    }

    .nav-btn:hover {
      opacity: 1;
    }

    #prevBtn { left: 30px; }
    #nextBtn { right: 30px; }
    
    /* ìƒë‹¨ ë²„íŠ¼ ê³µí†µ ìŠ¤íƒ€ì¼ */
    .top-btn {
        position: absolute;
        top: 30px;
        background: #0066ff; /* ë²„íŠ¼ ë°°ê²½ìƒ‰ í†µì¼ */
        color: white;
        border: none;
        border-radius: 8px;
        padding: 10px 14px;
        cursor: pointer;
        font-weight: bold;
        transition: background 0.3s, opacity 0.3s;
        z-index: 10;
    }

    .top-btn:hover {
        background: #0055e6;
    }

    body.dark .top-btn {
        background: #4a90e2;
    }
    
    body.dark .top-btn:hover {
        background: #5b9ce6;
    }

    /* í™ˆ ë²„íŠ¼ ìœ„ì¹˜ */
    #homeBtn { left: 30px; }

    /* ë‹¤í¬ëª¨ë“œ/ëª©ì°¨ ë²„íŠ¼ ìœ„ì¹˜ */
    #darkModeToggle { right: 130px; } /* ëª©ì°¨ ë²„íŠ¼ê³¼ì˜ ê°„ê²© ì¡°ì • */
    #tocToggle { right: 30px; } /* ê¸°ì¡´ ìœ„ì¹˜ ìœ ì§€ */

    .toc {
      position: absolute;
      top: 0;
      right: -300px;
      width: 300px;
      height: 100%;
      background: #222;
      color: white;
      transition: right 0.3s ease;
      overflow-y: auto;
      padding: 20px;
      z-index: 20;
    }

    .toc.open {
      right: 0;
    }

    .toc h3 {
      margin-top: 0;
    }

    .toc li {
      margin: 12px 0;
      cursor: pointer;
      color: #bbb;
    }

    .toc li:hover {
      color: white;
    }

    @media (max-width: 768px) {
      .page {
        width: 95%;
        padding: 20px;
      }

      .nav-btn {
        font-size: 18px;
        width: 40px;
        height: 40px;
      }
      
      .top-btn {
        padding: 8px 10px;
        font-size: 14px;
        top: 15px;
      }
      
      #homeBtn { left: 15px; }
      #darkModeToggle { right: 100px; }
      #tocToggle { right: 15px; }
    }
  </style>
</head>
<body>

  <div class="viewer">
    <button id="prevBtn" class="nav-btn">ã€ˆ</button>
    <button id="nextBtn" class="nav-btn">ã€‰</button>
    
    <button id="homeBtn" class="top-btn">ğŸ  í™ˆ</button>
    
    <button id="darkModeToggle" class="top-btn">ğŸŒ™ ë‹¤í¬ ëª¨ë“œ</button>
    
    <button id="tocToggle" class="top-btn">ğŸ“– ëª©ì°¨</button>

    <div class="page" id="page">
      <div class="page-text" id="pageText"></div>
      <div class="page-index" id="pageIndex"></div>
    </div>

    <div class="toc" id="toc">
      <h3>ëª©ì°¨</h3>
      <ul id="tocList"></ul>
    </div>
  </div>

  <script>
    const book = {
      title: "ê·€ì—¬ìš´ ìŒí–¥í•™ ì„œë¬¸",
      subtitle: "(ì¼ëŸ¬ìŠ¤íŠ¸: ìš°ë¦¬ ìŒí–¥í•™ì€ ì•ˆ ë¬¼ì–´ìš”!)",
      body: `â€˜ì†Œë¦¬â€™ëŠ” ê³µê¸°ì˜ ë¯¸ì„¸í•œ ì§„ë™ì„ ê·€ë¡œ ê°ì§€í•œ ê²ƒì„ ë§í•©ë‹ˆë‹¤. ë„“ì€ ì˜ë¯¸ì—ì„œëŠ” ê·€ë¡œ ë“¤ì„ ìˆ˜ ì—†ëŠ” ìˆœìˆ˜í•œ ì§„ë™ ìì²´ë„ ì†Œë¦¬ì˜ ë²”ì£¼ì— ë„£ê¸°ë„ í•©ë‹ˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´, â€˜ì´ˆìŒíŒŒâ€™ëŠ” ê·¸ ì§„ë™ì´ ë„ˆë¬´ ë¹¨ë¼ ì¸ê°„ì˜ ê·€ë¡œëŠ” ìŒì˜ ë†’ë‚®ì´ë¥¼ ì¸ì‹í•  ìˆ˜ ì—†ì§€ë§Œ, ê³µê°„ì„ í†µí•´ í¼ì ¸ë‚˜ê°€ëŠ” ë¬¼ë¦¬ì ì¸ ì§„ë™ì´ë¼ëŠ” ë³¸ì§ˆì ì¸ íŠ¹ì„±ì€ ì¼ë°˜ì ì¸ ì†Œë¦¬ì™€ ì •í™•íˆ ê°™ê¸° ë•Œë¬¸ì— ì†Œë¦¬ì˜ ì¼ì¢…ìœ¼ë¡œ ë´…ë‹ˆë‹¤. ì´ëŠ” ë§ˆì¹˜ ìì™¸ì„ ì´ë‚˜ ì ì™¸ì„ ì„ ìš°ë¦¬ê°€ ëˆˆìœ¼ë¡œ ë³¼ ìˆ˜ëŠ” ì—†ì§€ë§Œ, ì—¬ì „íˆ ê³µê°„ì„ í¼ì ¸ë‚˜ê°€ëŠ” ì „ìê¸°ì ì¸ ì§„ë™ì´ë¼ëŠ” ì¸¡ë©´ì—ì„œ ë¹¨ì£¼ë…¸ì´ˆíŒŒë‚¨ë³´ì˜ ê°€ì‹œê´‘ì„ ê³¼ ê°™ì€ â€˜ë¹›â€™ìœ¼ë¡œ ì·¨ê¸‰í•˜ëŠ” ê²ƒê³¼ë„ ê°™ìŠµë‹ˆë‹¤.

ëˆˆìœ¼ë¡œ ë³¼ ìˆ˜ ìˆëŠ” íŒŒì¥ ë²”ìœ„ì˜ ë¹›ì„ ê°€ì‹œê´‘ì„ (visible light)ì´ë¼ê³  ë¶€ë¥´ë“¯, ê·€ë¡œ ë“¤ì„ ìˆ˜ ìˆëŠ” ì£¼íŒŒìˆ˜ ë²”ìœ„ì˜ ì†Œë¦¬ë¥¼ ê°€ì²­ìŒ(audible sound)ì´ë¼ê³  í•©ë‹ˆë‹¤. ì¸ê°„ì˜ ê°ê°ê¸°ê´€ì´ ì¸ì§€í•  ìˆ˜ ìˆëŠ” ì™¸ë¶€ ìê·¹ì€ ì‹¤ì œë¡œ ì¡´ì¬í•˜ëŠ” ìê·¹ì˜ ê·¹íˆ ì¼ë¶€ì— ë¶ˆê³¼í•©ë‹ˆë‹¤.`
    };

    const charsPerPage = 1200; // í•œ í˜ì´ì§€ë‹¹ ê¸€ì ìˆ˜
    const pages = [];
    for (let i = 0; i < book.body.length; i += charsPerPage) {
      pages.push(book.body.slice(i, i + charsPerPage));
    }

    let currentPage = 0;
    const pageText = document.getElementById("pageText");
    const pageIndex = document.getElementById("pageIndex");
    const tocEl = document.getElementById("toc");
    const bodyEl = document.body;
    const darkModeToggle = document.getElementById("darkModeToggle");
    const initialDarkMode = localStorage.getItem('darkMode') === 'true'; // ì €ì¥ëœ ì„¤ì • í™•ì¸

    // ë‹¤í¬ ëª¨ë“œ ìƒíƒœë¥¼ ì„¤ì •í•˜ê³  ë²„íŠ¼ í…ìŠ¤íŠ¸ë¥¼ ì—…ë°ì´íŠ¸í•˜ëŠ” í•¨ìˆ˜
    function setDarkMode(isDark) {
        if (isDark) {
            bodyEl.classList.add("dark");
            darkModeToggle.innerText = "â˜€ï¸ ë¼ì´íŠ¸ ëª¨ë“œ";
            localStorage.setItem('darkMode', 'true');
        } else {
            bodyEl.classList.remove("dark");
            darkModeToggle.innerText = "ğŸŒ™ ë‹¤í¬ ëª¨ë“œ";
            localStorage.setItem('darkMode', 'false');
        }
    }
    
    // ì´ˆê¸° ëª¨ë“œ ì„¤ì • (ì €ì¥ëœ ì„¤ì •ì´ ì—†ìœ¼ë©´ ê¸°ë³¸ ë¼ì´íŠ¸ ëª¨ë“œë¡œ)
    setDarkMode(initialDarkMode);

    function renderPage() {
      const header = `<h1>${book.title}</h1><h2>${book.subtitle}</h2>`;
      pageText.innerHTML = header + "<p>" + pages[currentPage] + "</p>";
      pageIndex.innerText = `${currentPage + 1} / ${pages.length}`;
    }

    function renderTOC() {
      const tocList = document.getElementById("tocList");
      tocList.innerHTML = `<li onclick="goTo(0)">ê·€ì—¬ìš´ ìŒí–¥í•™ ì„œë¬¸</li>`;
    }

    function goTo(i) {
      currentPage = i;
      renderPage();
      tocEl.classList.remove("open");
    }

    document.getElementById("nextBtn").onclick = () => {
      if (currentPage < pages.length - 1) {
        currentPage++;
        renderPage();
      }
    };
    document.getElementById("prevBtn").onclick = () => {
      if (currentPage > 0) {
        currentPage--;
        renderPage();
      }
    };
    document.getElementById("tocToggle").onclick = () => {
      tocEl.classList.toggle("open");
    };
    document.getElementById("homeBtn").onclick = () => {
      window.location.href = "/"; // í™ˆìœ¼ë¡œ ì´ë™
    };
    
    // ë‹¤í¬ ëª¨ë“œ í† ê¸€ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ
    darkModeToggle.onclick = () => {
        const isDark = !bodyEl.classList.contains("dark");
        setDarkMode(isDark);
    };

    renderTOC();
    renderPage();

    // ëª¨ë°”ì¼ì—ì„œ ìŠ¬ë¼ì´ë“œë¡œ í˜ì´ì§€ ë„˜ì–´ê°€ê¸°
    let touchStartX = 0;
    let touchEndX = 0;
    
    document.body.addEventListener("touchstart", (e) => {
      touchStartX = e.changedTouches[0].screenX;
    });
    
    document.body.addEventListener("touchend", (e) => {
      touchEndX = e.changedTouches[0].screenX;
      if (touchStartX - touchEndX > 50) {
        if (currentPage < pages.length - 1) {
          currentPage++;
          renderPage();
        }
      } else if (touchEndX - touchStartX > 50) {
        if (currentPage > 0) {
          currentPage--;
          renderPage();
        }
      }
    });
  </script>

</body>
</html>