<style>
/* ========================================= */
/* 1. ‚öôÔ∏è CSS Î≥ÄÏàò ÏÑ§Ï†ï */
/* ========================================= */

:root {
  --header-h: 30px;
  --panel-h-default: 150px;
  --panel-h: var(--panel-h-default);
  --ide-w: 50px;
  --gut: 2.5vw;
}

@media (max-width: 768px) {
  :root {
    --panel-h-default: 110px;
    --panel-h: var(--panel-h-default);
    --ide-w: 0px;
  }
}

/* ========================================= */
/* 2. üóÑÔ∏è #mini-lecture Ïª®ÌÖåÏù¥ÎÑà */
/* ========================================= */

#mini-lecture {
  position: fixed;
  top: var(--header-h, 0);
  z-index: 40;
  left: calc(var(--ide-w) + var(--gut));
  right: var(--gut);
  height: var(--panel-h);
  min-height: 20px;
  display: grid;
  grid-template-rows: minmax(0, 1fr) 20px;
  overflow: hidden;
  box-shadow:
    0 60px 140px -30px rgba(0,0,0,.70),
    0 30px 70px -20px rgba(0,0,0,.60),
    0 14px 30px -10px rgba(0,0,0,.50),
    0 2px 8px -2px rgba(0,0,0,.45),
    0 0 0 1px rgba(0,0,0,.28);
}

body.panel-open #mini-lecture {
  left: calc(var(--ide-w) + var(--gut));
  right: var(--gut);
}

@media (min-width: 769px) {
  body.panel-open #mini-lecture {
    left:  calc(450px + var(--gut));
    right: var(--gut);
    width: auto;
  }
}

@media (max-width: 768px) {
  body, body.panel-open { padding-left: 0 !important; }
  #mini-lecture {
    top: 77px;
    left: 15px !important;
    right: 15px !important;
    width: auto !important;
    margin: 0 !important;
    padding-left: 0 !important;
  }
}

body.resizing { user-select: none; overflow: hidden; }

/* ========================================= */
/* 3. üìù Ìå®ÎÑê ÎÇ¥Î∂Ä UI */
/* ========================================= */

#mini-lecture .panel-card {
  background: #1a8b47f3;
  color: #ffffff;
  border: 1px solid #333;
  border-bottom: 0;
  padding: 16px;
  overflow: auto;
  min-height: 0;
  overscroll-behavior: contain;
  -webkit-overflow-scrolling: touch;
}

#mini-lecture .connector {
  display: inline-block;
  margin-bottom: 8px;
  background: #000;
  color: #fff;
  border: 1px solid #333;
  border-bottom: 0;
  border-radius: 10px;
  padding: 4px 10px;
  font-size: 12px;
  font-weight: 700;
}

/* ========================================= */
/* 4. üéöÔ∏è Î¶¨ÏÇ¨Ïù¥Ï†Ä */
/* ========================================= */

#panel-resizer {
  grid-row: 2;
  height: 18px;
  cursor: ns-resize;
  background: #313131;
  transition: background .15s ease, box-shadow .15s ease;
  position: relative;
  touch-action: none;
  user-select: none;
}

#panel-resizer::before {
  content: "";
  position: absolute;
  left: 50%; top: 50%;
  transform: translate(-50%, -50%);
  width: 70px; height: 4px;
  border-radius: 999px;
  background: linear-gradient(90deg, #777, #aaa, #777);
  opacity: .9;
}
</style>

<div id="mini-lecture" role="region" aria-label="ÎØ∏Îãà Í∞ïÏùò Ìå®ÎÑê">
 <div class="panel-card">
  <span class="connector" id="panel-title-connector">Welcome</span>
  <div class="panel-body">
    <% if (panelData && panelData.html) { %>
      <%- panelData.html %>
    <% } else { %>
      <h3><%= panelData.title %></h3>
      <p><%- panelData.body %></p>
    <% } %>
  </div>
</div>

  <div id="panel-resizer"
       role="separator"
       aria-orientation="horizontal"
       aria-valuemin="50"
       aria-valuemax="800"
       aria-valuenow="150"
       tabindex="0">
  </div>
</div>

<script>
/* ‚úÖ ÎÜíÏù¥ Ï°∞Ï†à Í∏∞Îä• */
window.initPanelResizer = function() {
  const root = document.documentElement;
  const resizer = document.getElementById('panel-resizer');
  if (!resizer) return;
  if (resizer.__bound_cleanup) { resizer.__bound_cleanup(); delete resizer.__bound_cleanup; }

  const VAR = '--panel-h';
  const KEY = 'miniPanelH_session';
  const MIN_HEIGHT = 35;
  const MAX_RATIO = 0.85;

  const clamp = h => Math.max(MIN_HEIGHT, Math.min(h, Math.floor(window.innerHeight * MAX_RATIO)));
  const setH = (h, save = false) => {
    const v = clamp(h);
    root.style.setProperty(VAR, v + 'px');
    if (save) sessionStorage.setItem(KEY, v + 'px');
  };

  // Ï¥àÍ∏∞ ÎÜíÏù¥ Î≥µÍµ¨
  const saved = sessionStorage.getItem(KEY);
  if (saved) setH(parseInt(saved), false);

  let startY, startH, drag = false;
  const down = e => { drag = true; startY = e.clientY; startH = parseInt(getComputedStyle(root).getPropertyValue(VAR)) || 150; };
  const move = e => { if(drag) setH(startH + (e.clientY - startY)); };
  const up = () => { if(drag){ drag = false; setH(parseInt(getComputedStyle(root).getPropertyValue(VAR)), true); } };

  resizer.addEventListener('pointerdown', down);
  document.addEventListener('pointermove', move);
  document.addEventListener('pointerup', up);

  resizer.__bound_cleanup = () => {
    resizer.removeEventListener('pointerdown', down);
    document.removeEventListener('pointermove', move);
    document.removeEventListener('pointerup', up);
  };
};
window.initPanelResizer();

/* ‚úÖ Ïä§ÌÅ¨Î°§ Ìä∏Îû© */
window.bindPanelScrollTrap = function() {
  const panel = document.getElementById('mini-lecture');
  const card = panel?.querySelector('.panel-card');
  if (!card) return;
  panel.addEventListener('wheel', e => { e.preventDefault(); card.scrollTop += e.deltaY; }, { passive:false });
};
window.bindPanelScrollTrap();
</script>
