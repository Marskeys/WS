<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<meta name="naver-site-verification" content="ddddc68fd5651c62d2758ed86b326cc802344e3d" />
<title>
  <%= (typeof metaTitle === 'string' && metaTitle.trim())
    ? metaTitle.trim()
    : (locale?.meta?.title || 'Bug Loop') %>
</title>

<%
  // ===== Meta description (page override > locale default) =====
  const rawDesc =
    (typeof metaDescription === 'string' && metaDescription.trim())
      ? metaDescription.trim()
      : (locale?.meta?.description ||
        "ì›¹ ê°œë°œì ë¸”ë¡œê·¸ | ì›¹ ê°œë°œ íŠœí† ë¦¬ì–¼ & ì˜¨ë¼ì¸ ì½”ë“œ í¸ì§‘ê¸°, ê·¸ë¦¬ê³  ì´ˆí•™ì œì  ê´€ì ì˜ ì¸ì‚¬ì´íŠ¸ê¹Œì§€ í•œ ê³³ì—!");
  const DESC = rawDesc.length > 160 ? (rawDesc.slice(0,157) + 'â€¦') : rawDesc;

  // ===== Canonical / OG helpers =====
  const SITE_ORIGIN = 'https://bugloop.dev';
  const path = (typeof currentPath === 'string' && currentPath) ? currentPath : '/';
  const canonicalUrl = (typeof canonical === 'string' && canonical.trim()) ? canonical.trim() : (SITE_ORIGIN + path);
  const ogImage = (typeof metaImage === 'string' && metaImage.trim()) ? metaImage.trim() : '/assets/logo.png';
  const OG_IMAGE_ABS = /^https?:\/\//.test(ogImage) ? ogImage : (SITE_ORIGIN + ogImage);
  const PAGE_TITLE =
    (typeof metaTitle === 'string' && metaTitle.trim())
      ? metaTitle.trim()
      : (locale?.meta?.title || 'Bug Loop');
%>

<meta name="description" content="<%= DESC %>" />
<meta property="og:title" content="<%= PAGE_TITLE %>" />
<meta property="og:description" content="<%= DESC %>" />
<meta property="og:type" content="website" />
<meta property="og:url" content="<%= canonicalUrl %>" />
<meta property="og:image" content="<%= OG_IMAGE_ABS %>" />
<meta property="og:image:alt" content="Bug Loop logo" />

<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:title" content="<%= PAGE_TITLE %>" />
<meta name="twitter:description" content="<%= DESC %>" />
<meta name="twitter:image" content="<%= OG_IMAGE_ABS %>" />

<link rel="canonical" href="<%= canonicalUrl %>" />

<meta name="theme-color" content="#000000" media="(prefers-color-scheme: light)" />
<meta name="theme-color" content="#000000" media="(prefers-color-scheme: dark)" />

<link rel="icon" href="/assets/images/favicon.png" type="image/png" sizes="128x128" />

<link rel="preconnect" href="https://fonts.googleapis.com" />
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
<link href="https://fonts.googleapis.com/css2?family=Gowun+Dodum&family=Noto+Sans+KR:wght@400;700&family=Noto+Serif+KR&display=swap" rel="stylesheet" />
<link rel="preconnect" href="https://fonts.googleapis.com" />
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
<link href="https://fonts.googleapis.com/css2?family=Asta+Sans:wght@100..900&display=swap" rel="stylesheet" />

<link rel="preconnect" href="https://cdn.jsdelivr.net" crossorigin />
<link rel="stylesheet" as="style" crossorigin
      href="https://cdn.jsdelivr.net/gh/orioncactus/pretendard/dist/web/variable/pretendardvariable.css" />

<link rel="stylesheet" href="/assets/css/header.css" />
<link rel="stylesheet" href="/assets/css/style.css" />
<link rel="stylesheet" href="/assets/css/table.css" />
<link rel="stylesheet" href="/assets/css/darkmode.css" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flag-icons@6.6.6/css/flag-icons.min.css" />

<script async custom-element="amp-auto-ads"
        src="https://cdn.ampproject.org/v0/amp-auto-ads-0.1.js"></script>

<link rel="preload" href="/assets/images/profile.gif" as="image" type="image/gif" />
<link rel="preload" href="/assets/images/room.webp" as="image" type="image/webp" />

<script>
  (function () {
    try {
      // ğŸ’¥ í…Œë§ˆ í‚¤ ìˆ˜ì •: 'theme-mode' -> 'bugloop.theme' (header.jsì™€ í†µì¼)
      const THEME_KEY = 'bugloop.theme';
      const htmlEl = document.documentElement;
      const saved = localStorage.getItem(THEME_KEY);
      let theme;

      // 1. ì €ì¥ëœ ê°’ì´ ìˆë‹¤ë©´, ë¬´ì¡°ê±´ ê·¸ ê°’ì„ ì‚¬ìš©í•©ë‹ˆë‹¤. (ì‹œìŠ¤í…œ ì„¤ì • ë¬´ì‹œ)
      if (saved) {
        theme = saved;
      } else {
        // 2. ì €ì¥ëœ ê°’ì´ ì—†ë‹¤ë©´, ì‹œìŠ¤í…œ ì„¤ì •ì„ í™•ì¸í•©ë‹ˆë‹¤.
        const prefersDark = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;
        theme = prefersDark ? 'dark' : 'light';
      }
      
      // 3. <html>ì— í´ë˜ìŠ¤ ì¦‰ì‹œ ì ìš©
      if (theme === 'dark') {
        htmlEl.classList.add('dark');
      } else {
        htmlEl.classList.remove('dark');
      }
      
    } catch (e) {
      console.warn("Theme initialization failed:", e);
    }
  })();
</script>

<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-2585969189290118" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/js-beautify/1.14.0/beautify-html.min.js"></script>