<!DOCTYPE html>
<html lang="<%= lang %>">
<head>
  <%
// í…ŒìŠ¤íŠ¸ ê´€ë ¨ í‚¤ì›Œë“œë“¤ ì •ì˜
[cite_start]const testKeywords = ['í…ŒìŠ¤íŠ¸', 'Test', 'ãƒ†ã‚¹ãƒˆ', 'æµ‹è¯•', 'Test 2', 'í…ŒìŠ¤íŠ¸ 2', 'ãƒ†ã‚¹ãƒˆ2', 'æµ‹è¯•2']; [cite: 1]
const hasTestCategory = post.categories.some(cat =>
  testKeywords.some(keyword => cat.includes(keyword))
[cite_start]); [cite: 2]
%>

<% if (hasTestCategory) { %>
  <meta name="robots" content="noindex">
<% } %>
  <title><%= post.title %> | [cite_start]BlindLove</title> [cite: 3]
  <link rel="stylesheet" href="/assets/css/signup.css" />
  <link rel="stylesheet" href="/assets/css/post-view.css" />
  <%- include('partials/head') %>

  <% if (canonicalUrl) { %>
    <link rel="canonical" href="<%= canonicalUrl %>">
  <% } %>

  <% if (alternateLinks && alternateLinks.length > 0) { %>
    <% alternateLinks.forEach(link => { %>
      <link rel="alternate" hreflang="<%= link.lang %>" href="<%= link.href %>">
    <% }); %>
    [cite_start]<link rel="alternate" hreflang="x-default" href="https://blindly.love/<%= lang %>/post/<%= post.id %>"> [cite: 4]
  <% } %>
  <style>
    /* ğŸ“‘ ëª©ì°¨ ë°•ìŠ¤ ë””ìì¸ */
    .toc-list {
      font-size: 0; [cite_start]/* ì¤„ë°”ê¿ˆ ê³µë°± ì œê±° */ [cite: 5]
    }

    .toc-list a {
      [cite_start]font-size: 14px; [cite: 6]
      display: block; [cite_start]/* í•œ ì¤„ ì „ì²´ í´ë¦­ ê°€ëŠ¥ */ [cite: 6]
      line-height: 1.4;
      [cite_start]padding: 2px 6px; [cite: 7]
      [cite_start]border-radius: 4px; [cite: 7]
      color: #0366d6;
      text-decoration: none;
      [cite_start]transition: all 0.2s ease; [cite: 8]
    }

    .toc-list a:hover {
      color: #999ff9 !important;
      [cite_start]text-decoration: underline !important; [cite: 9]
    }

    html.dark .toc-list a {
      [cite_start]color: #6fb7ff !important; [cite: 10]
    }

    html.dark .toc-list a:hover {
      [cite_start]color: #a2d4ff !important; [cite: 11]
    }

    .toc-item.toc-h2 {
      padding-left: 1.2rem; [cite_start]/* âœ… ë¶€ì œëª© ë“¤ì—¬ì“°ê¸°*/ [cite: 12]
    }
    .post-content ul, .post-content ol {
      [cite_start]padding-left: 1em; [cite: 13]
      [cite_start]margin: 0.3rem 0; [cite: 13]
    }

    .post-content li {
      margin: 0;
      [cite_start]padding: 0; [cite: 14]
    }

    .post-content footer {
      display: block;
      font-size: 0.85rem;
      [cite_start]color: #666; [cite: 15]
      [cite_start]margin: 0.3em 0; [cite: 15]
      line-height: 1.5;
    }

    html.dark .post-content footer {
      [cite_start]color: #aaa; [cite: 16]
    }

    .post-content .auto-toc {
      background: #f7f9fa;
      [cite_start]border: 1px solid #d0d7de; [cite: 17]
      [cite_start]padding: 1rem 1rem; [cite: 17]
      margin-bottom: 1rem;
      border-radius: 6px;
      font-size: 0.95rem;
      line-height: 1.4;
      max-width: 280px;
      width: 100%;
      margin-left: 0;
      [cite_start]margin-right: auto; [cite: 18]
    }
    /* ëª¨ë“  h1ì— ê¸°ë³¸ ìœ„ ì—¬ë°±ì„ ì¤Œ */
    .post-content .auto-toc li.toc-h1 {
      [cite_start]margin-top: 0.8rem; [cite: 19]
    }
    .post-content .auto-toc .toc-title {
      font-weight: bold;
      margin-bottom: 0rem;
      [cite_start]display: block; [cite: 20]
    }

    .post-content .auto-toc ul {
      list-style: none;
      padding: 0;
      [cite_start]margin: 0; [cite: 21]
    }

    .post-content .auto-toc li {
      margin: 0.1em 0;
      line-height: 1.2;
      [cite_start]padding-right: 0; [cite: 22]
    }

    html.dark .post-content .auto-toc {
      background: #1f1f2b;
      [cite_start]border: 1px solid #444; [cite: 23]
      [cite_start]color: #ddd; [cite: 23]
    }

    /* ì œëª© ê°„ê²© ì¡°ì • */
    .post-content h1,
    .post-content h2 {
      [cite_start]margin-top: 0.8em; [cite: 24]
      [cite_start]margin-bottom: 0.4em; [cite: 24]
      line-height: 1.3;
    }

   .post-content .auto-toc + h1,
    .post-content .auto-toc + h2 {
      [cite_start]margin-top: 0.5rem !important; [cite: 25]
    } 

    .post-title {
      font-size: 1.5rem;
      font-weight: bold;
      text-align: center;
      [cite_start]margin-bottom: 1rem; [cite: 26]
    }

    .post-meta {
      text-align: center;
      font-size: 0.9rem;
      color: #777;
      [cite_start]margin-bottom: 2rem; [cite: 27]
    } 

    /* ì´ê²Œ ë¬¸ì œ */ 
    .post-content {
      [cite_start]line-height: 1.7; [cite: 28]
      [cite_start]font-size: 1rem; [cite: 28]
      white-space: pre-wrap; 
      color: #333;
      max-width: 640px;
      margin: 0 auto;
      padding-left: 0.5rem;
      [cite_start]position: relative; [cite: 29]
    } 

    html.dark body .post-content {
      [cite_start]color: #ddd; [cite: 30]
    }

    .post-actions a.edit-btn,
    .post-actions form button {
      [cite_start]display: inline-block; [cite: 31]
      [cite_start]padding: 4px 10px; [cite: 31]
      margin: 0 4px;
      border: none;
      border-radius: 6px;
      font-size: 0.75rem;
      font-weight: 500;
      [cite_start]cursor: pointer; [cite: 32]
      [cite_start]transition: background 0.2s ease, color 0.2s ease; [cite: 32]
    }

    .post-actions a.edit-btn {
      [cite_start]background-color: #f0f8ff; [cite: 33]
      [cite_start]color: #0077cc; [cite: 33]
      text-decoration: none;
    }

    .post-actions a.edit-btn:hover {
      background-color: #d8edff;
      [cite_start]color: #005fa3; [cite: 34]
    }

    .post-actions form button {
      background-color: #fff0f0;
      [cite_start]color: #cc0000; [cite: 35]
      [cite_start]border: 1px solid #cc0000; [cite: 35]
    }

    .post-actions form button:hover {
      [cite_start]background-color: #ffe5e5; [cite: 36]
      [cite_start]color: #a30000; [cite: 36]
    }

    .logo-wrap {
      display: flex;
      justify-content: center;
      [cite_start]align-items: center; [cite: 37]
    }

    .logo-wrap img {
      max-width: 150px;
      height: auto;
      display: block;
      [cite_start]margin-bottom: 1rem; [cite: 38]
    }

    /* ë¸”ëŸ­ ìš”ì†Œë“¤ ì‚¬ì´ ê°„ê²© ì¡°ì ˆ*/
    .post-content p {
      [cite_start]margin-bottom: 2rem; [cite: 39]
    }

    .post-content h1 {
      margin-top: 2rem;
    }

    .post-content h2 {
      margin-bottom: 2rem;
      [cite_start]margin-top: 2rem; [cite: 40]
    }
    
    /* ê¸°ì¡´ í”Œë¡œíŒ… ëª©ì°¨ (ë°ìŠ¤í¬í†±) ë””ìì¸ ìœ ì§€ */
    .floating-toc {
      position: fixed;
      top: 100px; /* ì ì ˆí•œ ì´ˆê¸° ìœ„ì¹˜ ì¡°ì • */
      right: 20px; /* ì ì ˆí•œ ì´ˆê¸° ìœ„ì¹˜ ì¡°ì • */
      background-color: #f9f9f9;
      border: 1px solid #ddd;
      padding: 10px;
      border-radius: 5px;
      max-height: 80vh;
      overflow-y: auto;
      z-index: 999;
      display: none; /* ê¸°ë³¸ ìˆ¨ê¹€ */
      opacity: 0;
      transition: opacity 0.3s ease-in-out;
      cursor: grab; /* ë“œë˜ê·¸ ê°€ëŠ¥í•¨ì„ í‘œì‹œ */
    }

    .floating-toc.show {
      opacity: 1;
      display: block; /* opacity transitionì„ ìœ„í•´ blockìœ¼ë¡œ ë³€ê²½ í›„ opacity 1 */
    }

    /* ëª¨ë‹¬ì´ ì—´ë ¸ì„ ë•Œ body ìŠ¤í¬ë¡¤ ë°©ì§€ */
    body.modal-open {
        overflow: hidden;
    }
  </style>
</head>
<body class="no-fixed-footer">
  <%- include('partials/header') %>

  <div class="signup-container">
    <div class="logo-wrap">
      <a href="/<%= lang %>/">
        <img src="/assets/images/post-view.png" alt="BlindLove ë¡œê³ " />
      </a>
    </div>

    <div class="post-title"><%= post.title %></div>

    <div class="post-meta">
      <span>ì¹´í…Œê³ ë¦¬: <%= post.categories.join(', ') %></span><br>
      <span>ì‘ì„±ì: <%= post.author %></span><br>
      <span>ì‘ì„±ì¼: <%= new Date(post.created_at).toLocaleString() %></span>
    </div>

    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-2585969189290118"
      [cite_start]crossorigin="anonymous"></script> [cite: 41]
    <ins class="adsbygoogle"
         [cite_start]style="display:block; text-align:center;" [cite: 42]
         data-ad-layout="in-article"
         data-ad-format="fluid"
         data-ad-client="ca-pub-2585969189290118"
         data-ad-slot="3406391330"></ins>
    <script>(adsbygoogle = window.adsbygoogle || []).push({});</script>

    <div class="post-content">
      <%- post.content %>
    </div>

    <% if (user && post.user_id == user.id) { %>
      <div class="post-actions" style="text-align: center; margin-top: 1.5rem;">
        <a href="/<%= lang %>/edit/<%= post.id %>" class="edit-btn">âœï¸ ìˆ˜ì •í•˜ê¸°</a>
        <form action="/<%= lang %>/delete/<%= post.id %>" method="POST" style="display: inline;">
          [cite_start]<button type="submit" onclick="return confirm('ì •ë§ ì‚­ì œí•˜ì‹œê² ì–´ìš”?');">ğŸ—‘ ì‚­ì œí•˜ê¸°</button> [cite: 43]
        </form>
      </div>
    <% } %>

    <div class="extra" style="margin-top: 2rem; text-align: center;">
      <a href="/<%= lang %>/" class="back-home-link">â† í™ˆìœ¼ë¡œ ëŒì•„ê°€ê¸°</a>
    </div>
  </div>

  <script>
    // ----------------------------------------------------
    // ëª¨ë“  DOM ë¡œë”©ì´ ì™„ë£Œëœ í›„ ìŠ¤í¬ë¦½íŠ¸ ì‹¤í–‰
    // ----------------------------------------------------
    document.addEventListener("DOMContentLoaded", () => {
  
      // 1. HTML ìœ„ì ¯(iframe) ì²˜ë¦¬ ë¡œì§
      [cite_start]document.querySelectorAll('.custom-widget[data-type="html-snippet"]').forEach((el, index) => { [cite: 44]
        [cite_start]const encoded = el.getAttribute("data-code"); [cite: 45]
        if (!encoded) return;
  
        try {
          [cite_start]const binaryString = atob(encoded); [cite: 46]
          [cite_start]const len = binaryString.length; [cite: 46]
          const bytes = new Uint8Array(len);
          for (let i = 0; i < len; i++) {
            [cite_start]bytes[i] = binaryString.charCodeAt(i); [cite: 47]
          }
          const decoder = new TextDecoder('utf-8');
          [cite_start]const decoded = decoder.decode(bytes); [cite: 48]
          [cite_start]const iframe = document.createElement('iframe'); [cite: 48]
          iframe.setAttribute('sandbox', 'allow-scripts');
          iframe.setAttribute('referrerpolicy', 'no-referrer');
          iframe.setAttribute('title', 'ì‚½ì…ëœ HTML');
          iframe.setAttribute('name', `snippet-iframe-${index}`);
  
          iframe.style.width = '100%';
          [cite_start]iframe.style.minHeight = '100px'; [cite: 49]
          [cite_start]iframe.style.border = '1px solid #ccc'; [cite: 49]
          iframe.style.borderRadius = '8px';
          iframe.style.margin = '1rem 0';
          iframe.srcdoc = decoded;
  
          el.innerHTML = '';
          [cite_start]el.appendChild(iframe); [cite: 50]
        } catch (e) {
          [cite_start]el.innerHTML = '<p style="color:red;">[HTML ì½”ë“œ ë””ì½”ë”© ì‹¤íŒ¨]</p>'; [cite: 51]
          [cite_start]console.error('ë””ì½”ë”© ì˜¤ë¥˜:', e); [cite: 51]
        }
      [cite_start]}); [cite: 52]
      // 2. ë³¸ë¬¸ ë‚´ ê´‘ê³  ë™ì  ì‚½ì… ë¡œì§
      const adCode = `
        <ins class="adsbygoogle"
             style="display:block"
             data-ad-client="ca-pub-2585969189290118"
             data-ad-slot="7758400001"
             data-ad-format="auto"
             data-full-width-responsive="true"></ins>
      `;
      [cite_start]const postContent = document.querySelector('.post-content'); [cite: 53]
      if (postContent) {
        [cite_start]const potentialAdTargets = postContent.querySelectorAll('p, h2'); [cite: 54]
        const adPositions = [2, 6]; // ğŸ‘ˆ ê´‘ê³  ìœ„ì¹˜ëŠ” ì—¬ê¸°ì„œ ì¡°ì ˆ
  
        adPositions.forEach(position => {
          if (potentialAdTargets.length > position) {
            const targetElement = potentialAdTargets[position];
            const adContainer = document.createElement('div');
            adContainer.innerHTML = adCode;
            
            [cite_start]targetElement.insertAdjacentElement('afterend', adContainer); [cite: 55]
            
            try {
              (adsbygoogle = window.adsbygoogle || []).push({});
            } catch (e) {
              console.error("Adsense push error: ", e);
            }
          }
        [cite_start]}); [cite: 56]
      [cite_start]} [cite: 57]
  
      // 3. .post-body ì•ˆì˜ ìŠ¤í¬ë¦½íŠ¸ ì‹¤í–‰ ë¡œì§ (í•„ìš” ì‹œ ì‚¬ìš©)
      document.querySelectorAll('.post-body script').forEach(script => {
          const newScript = document.createElement('script');
          if (script.src) {
              newScript.src = script.src;
          } else {
              newScript.textContent = script.textContent;
          [cite_start]} [cite: 58]
          document.body.appendChild(newScript);
      [cite_start]}); [cite: 59]
    });
  
    // ----------------------------------------------------
    // iframe ë†’ì´ ì¡°ì ˆ ê´€ë ¨ í•¨ìˆ˜ ë° ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ
    // (DOMContentLoaded ë°”ê¹¥ì— ìˆì–´ë„ ê´œì°®ì€ ë¶€ë¶„)
    // ----------------------------------------------------
    function sendHeightToParent() {
      [cite_start]const body = document.body; [cite: 60]
      [cite_start]const html = document.documentElement; [cite: 60]
      const height = Math.max(body.scrollHeight, body.offsetHeight, html.clientHeight, html.scrollHeight, html.offsetHeight);
      [cite_start]const iframeName = window.name; [cite: 61]
      [cite_start]if (window.parent) { [cite: 61]
        window.parent.postMessage({
          type: 'setIframeHeight',
          height: height,
          iframeName: iframeName
        [cite_start]}, '*'); [cite: 62]
      }
    }
  
    window.addEventListener('message', (event) => {
      if (event.data && event.data.type === 'setIframeHeight') {
        const iframeName = event.data.iframeName;
        const height = event.data.height;
        const targetIframe = document.querySelector(`iframe[name="${iframeName}"]`);
        if (targetIframe) {
          targetIframe.style.height = `${height}px`;
        }
      }
    [cite_start]}); [cite: 63]
    [cite_start]window.addEventListener('load', sendHeightToParent); [cite: 63]
    [cite_start]window.addEventListener('resize', sendHeightToParent); [cite: 63]
  </script>
 
  <div class="floating-toc" id="floatingToc"></div>
  <div class="mobile-toc-button" id="mobileTocBtn"><%= locale.ui.tocButton %></div>
  <div class="mobile-toc-modal" id="mobileTocModal">
    <div class="mobile-toc-content" id="mobileTocContent"></div>
    <button class="mobile-toc-close-btn" id="mobileTocCloseBtn">X</button>
  </div>


  <script>
    document.addEventListener("DOMContentLoaded", () => {
      const toc = document.querySelector(".auto-toc");
      const floatingToc = document.getElementById("floatingToc");
      const mobileBtn = document.getElementById("mobileTocBtn");
      const mobileModal = document.getElementById("mobileTocModal");
      const mobileContent = document.getElementById("mobileTocContent");
      const mobileTocCloseBtn = document.getElementById("mobileTocCloseBtn"); // ëª¨ë°”ì¼ ë‹«ê¸° ë²„íŠ¼ ìš”ì†Œ ê°€ì ¸ì˜¤ê¸°

      // .auto-tocì´ ì—†ìœ¼ë©´ ëª©ì°¨ ê¸°ëŠ¥ ë¹„í™œì„±í™”
      if (!toc) {
        if (floatingToc) floatingToc.style.display = 'none';
        if (mobileBtn) mobileBtn.style.display = 'none';
        return;
      }
    
      // 1. ëª©ì°¨ ë‚´ìš©ì„ í”Œë¡œíŒ… ëª©ì°¨ì™€ ëª¨ë°”ì¼ ëª©ì°¨ ëª¨ë‹¬ì— ë³µì‚¬
      [cite_start]floatingToc.innerHTML = toc.innerHTML; [cite: 64]
      [cite_start]mobileContent.innerHTML = toc.innerHTML; [cite: 64]
    
      // 2. ëª¨ë°”ì¼ íŒì—… ê¸°ëŠ¥
      if (mobileBtn) {
        mobileBtn.addEventListener("click", () => {
          if (mobileModal) {
            mobileModal.classList.add("show");
            [cite_start]document.body.classList.add("modal-open"); // ìŠ¤í¬ë¡¤ ë§‰ê¸° [cite: 65]
          }
        });
      }

      if (mobileTocCloseBtn) { // ë‹«ê¸° ë²„íŠ¼ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì¶”ê°€
        mobileTocCloseBtn.addEventListener("click", () => {
          if (mobileModal) {
            mobileModal.classList.remove("show");
            document.body.classList.remove("modal-open"); // ë‹¤ì‹œ ìŠ¤í¬ë¡¤ í—ˆìš©
          }
        });
      }
    
      [cite_start]if (mobileModal) { [cite: 66]
        [cite_start]mobileModal.addEventListener("click", (e) => { [cite: 66]
          if (e.target === mobileModal) { // ëª¨ë‹¬ ë°°ê²½ í´ë¦­ ì‹œ
            mobileModal.classList.remove("show");
            document.body.classList.remove("modal-open"); [cite_start]// ë‹¤ì‹œ ìŠ¤í¬ë¡¤ í—ˆìš© [cite: 66]
          }
        });
      }
    
      // ëª¨ë°”ì¼ ëª©ì°¨ ë§í¬ í´ë¦­ ì‹œ ëª¨ë‹¬ ë‹«ê³  ìŠ¤í¬ë¡¤ ì´ë™
      [cite_start]if (mobileContent) { [cite: 67]
        [cite_start]mobileContent.addEventListener("click", (e) => { [cite: 67]
          if (e.target.tagName === "A") {
            e.preventDefault(); // ê¸°ë³¸ ë§í¬ ì´ë™ ë°©ì§€
            const targetId = e.target.getAttribute("href").replace("#", "");
            const el = document.getElementById(targetId);
            if (el) {
              el.scrollIntoView({ behavior: "smooth" });
              if (mobileModal) {
                mobileModal.classList.remove("show");
                document.body.classList.remove("modal-open"); // ë‹¤ì‹œ ìŠ¤í¬ë¡¤ í—ˆìš©
              }
            }
          }
        [cite_start]}); [cite: 68]
      }
    
      // 3. ìŠ¤í¬ë¡¤ ìœ„ì¹˜ì— ë”°ë¥¸ í”Œë¡œíŒ… ëª©ì°¨/ëª¨ë°”ì¼ ë²„íŠ¼ í‘œì‹œ ê¸°ëŠ¥ (ì„¼í‹°ë„¬ í™œìš©)
      [cite_start]const topSentinel = document.createElement("div"); [cite: 69]
      [cite_start]topSentinel.style.height = "1px"; [cite: 69]
      toc.before(topSentinel); [cite_start]// ë³¸ë¬¸ ë‚´ ëª©ì°¨ ìœ„ì— ì„¼í‹°ë„¬ ì‚½ì… [cite: 69]
    
      [cite_start]const bottomSentinel = document.createElement("div"); [cite: 70]
      [cite_start]bottomSentinel.style.height = "1px"; [cite: 70]
      toc.after(bottomSentinel); [cite_start]// ë³¸ë¬¸ ë‚´ ëª©ì°¨ ì•„ë˜ì— ì„¼í‹°ë„¬ ì‚½ì… [cite: 70]
    
      // ì‹¤ì‹œê°„ ìœ„ì¹˜ í™•ì¸ í•¨ìˆ˜
      const checkFloatingToc = () => {
        [cite_start]const top = topSentinel.getBoundingClientRect().top; [cite: 71]
        [cite_start]const bottom = bottomSentinel.getBoundingClientRect().top; [cite: 71]
        const vh = window.innerHeight || document.documentElement.clientHeight;
    
        // ë³¸ë¬¸ ë‚´ ëª©ì°¨ê°€ í™”ë©´ ìœ„ë¡œ ì™„ì „íˆ ì§€ë‚˜ê°”ëŠ”ì§€ (topSentinelì´ í™”ë©´ ìœ„ë¡œ, bottomSentinelë„ í™”ë©´ ìœ„ë¡œ)
        [cite_start]const isTocFullyPassed = top < 0 && bottom < 0; [cite: 72]
    
        // ë°ìŠ¤í¬í†± (í”Œë¡œíŒ… ëª©ì°¨)
        if (window.innerWidth > 768) { 
          if (isTocFullyPassed) {
            [cite_start]floatingToc.classList.add("show"); [cite: 73]
          } else {
            floatingToc.classList.remove("show");
          }
        } else { // ëª¨ë°”ì¼ (í”Œë¡œíŒ… ëª©ì°¨ëŠ” í•­ìƒ ìˆ¨ê¹€)
          floatingToc.classList.remove("show");
        }

        // ëª¨ë°”ì¼ (ëª¨ë°”ì¼ ë²„íŠ¼)
        if (mobileBtn) { // mobileBtnì´ ì¡´ì¬í•˜ëŠ”ì§€ í™•ì¸
            if (window.innerWidth <= 768) { // ëª¨ë°”ì¼ì—ì„œë§Œ
                if (isTocFullyPassed) {
                    mobileBtn.classList.add("show");
                } else {
                    mobileBtn.classList.remove("show");
                }
            } else { // ë°ìŠ¤í¬í†±ì—ì„œëŠ” ëª¨ë°”ì¼ ë²„íŠ¼ ìˆ¨ê¹€
                mobileBtn.classList.remove("show");
            }
        }
      };
    
      // ìŠ¤í¬ë¡¤, ë¦¬ì‚¬ì´ì¦ˆ ì‹œ í™•ì¸
      [cite_start]window.addEventListener("scroll", checkFloatingToc); [cite: 74]
      [cite_start]window.addEventListener("resize", checkFloatingToc); [cite: 75]
      checkFloatingToc(); [cite_start]// ì²˜ìŒ ë¡œë“œ ì‹œ í™•ì¸ [cite: 75]
    });
  </script>

  <script>
    (function enableFloatingTocDrag() [cite_start]{ [cite: 76]
      [cite_start]const toc = document.getElementById('floatingToc'); [cite: 77]
      if (!toc) return;

      let isDragging = false;
      let startX, startY;
      let startLeft, startTop;

      [cite_start]toc.addEventListener('mousedown', (e) => { [cite: 77]
        isDragging = true;
        startX = e.clientX;
        startY = e.clientY;
        startLeft = parseInt(window.getComputedStyle(toc).left, 10) || toc.offsetLeft; // ì´ˆê¸° left ê°’
        startTop = parseInt(window.getComputedStyle(toc).top, 10) || toc.offsetTop; // ì´ˆê¸° top ê°’
        toc.style.transition = 'none'; // ë“œë˜ê·¸í•  ë•Œ ë¶€ë“œëŸ½ê²Œ ì•ˆ ë°€ë¦¬ê²Œ
        toc.style.cursor = 'grabbing'; // ë“œë˜ê·¸ ì¤‘ ì»¤ì„œ ë³€ê²½
        e.preventDefault(); // í…ìŠ¤íŠ¸ ì„ íƒ ë°©ì§€
      });

      document.addEventListener('mousemove', (e) => {
        if (!isDragging) return;
        [cite_start]const dx = e.clientX - startX; [cite: 77]
        [cite_start]const dy = e.clientY - startY; [cite: 77]
        toc.style.left = `${startLeft + dx}px`;
        toc.style.top = `${startTop + dy}px`;
      });

      [cite_start]document.addEventListener('mouseup', () => { [cite: 77]
        isDragging = false;
        toc.style.transition = ''; // ë“œë˜ê·¸ ëë‚˜ë©´ íŠ¸ëœì§€ì…˜ ë‹¤ì‹œ í™œì„±í™”
        toc.style.cursor = 'grab'; // ì»¤ì„œ ì›ë˜ëŒ€ë¡œ
      });
    [cite_start]})(); [cite: 78]
  </script>
    
  <%- include('partials/footer') %>
  <%- include('partials/scripts') %>

</body>
</html>