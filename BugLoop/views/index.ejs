<!DOCTYPE html>
<html class="dark" lang="<%= lang %>">
  <%- include('partials/head') %>
  <link rel="stylesheet" href="/assets/css/index.css" />

  <body class="light">
    <%- include('partials/header') %>

    <div class="full-layout">
      <div class="main-layout">
        <div class="main-panel">
        
        
          <section class="code-preview-wrapper">
            <h1 class="code-preview-title">🧪 안전한 HTML/CSS/JS 미리보기</h1>
            <div class="code-preview-tabs">
              <button class="code-preview-tab active" data-tab="html">HTML</button>
              <button class="code-preview-tab" data-tab="css">CSS</button>
              <button class="code-preview-tab" data-tab="js">JS</button>
            </div>

            <div class="code-preview-editors">
              <div id="code-preview-html" class="code-preview-editor active">
                <textarea id="code-preview-html-code">
<h1>Hello World!</h1>
<p>iframe 안에서 안전하게 실행돼요 🛡️</p>
                </textarea>
              </div>
              <div id="code-preview-css" class="code-preview-editor">
                <textarea id="code-preview-css-code">
body {
  background: #fff;
  color: #222;
  font-family: sans-serif;
  text-align: center;
  padding-top: 50px;
}
h1 {
  color: #00f5d4;
}
                </textarea>
              </div>
              <div id="code-preview-js" class="code-preview-editor">
                <textarea id="code-preview-js-code">
// iframe 안에서만 실행됩니다.
document.body.style.transform = 'scale(1.02)';
                </textarea>
              </div>
            </div>

            <iframe id="code-preview-frame" sandbox="allow-scripts"></iframe>
          </section>

        </div>
      </div>
    </div>

    <%- include('partials/scripts') %>

    <style>
   .code-preview-wrapper {
  position: absolute;
  top: 100px;
  bottom: 0;
  left: 0;
  right: 0;
  overflow: auto;
  padding: 40px 20px;
  background: #1e1e1e;
  color: white;
  box-sizing: border-box;
}

      .code-preview-title {
        font-size: 1.8rem;
        text-align: center;
        margin-bottom: 20px;
      }

      .code-preview-tabs {
        display: flex;
        justify-content: center;
        background: #333;
        border-radius: 8px;
        overflow: hidden;
        margin-bottom: 15px;
      }

      .code-preview-tab {
        flex: 1;
        padding: 12px;
        text-align: center;
        background: #333;
        color: #ccc;
        font-weight: 500;
        border: none;
        cursor: pointer;
        transition: 0.2s ease;
      }

      .code-preview-tab.active {
        background: #222;
        color: #00f5d4;
      }

      .code-preview-editors {
        width: 100%;
      }

      .code-preview-editor {
        display: none;
      }

      .code-preview-editor.active {
        display: block;
      }

      textarea {
        width: 100%;
        height: 220px;
        background: #111;
        color: #0ff;
        border: none;
        padding: 12px;
        font-family: monospace;
        font-size: 14px;
        resize: vertical;
        border-radius: 10px;
        outline: none;
      }

      #code-preview-frame {
        width: 100%;
        height: 400px;
        margin-top: 20px;
        border: 1px solid #444;
        background: white;
        border-radius: 10px;
      }
    </style>

    <script>
      const codeTabs = document.querySelectorAll('.code-preview-tab');
      const codeEditors = document.querySelectorAll('.code-preview-editor');
      const htmlInput = document.getElementById('code-preview-html-code');
      const cssInput = document.getElementById('code-preview-css-code');
      const jsInput = document.getElementById('code-preview-js-code');
      const preview = document.getElementById('code-preview-frame');

      codeTabs.forEach(tab => {
        tab.addEventListener('click', () => {
          codeTabs.forEach(t => t.classList.remove('active'));
          codeEditors.forEach(e => e.classList.remove('active'));
          tab.classList.add('active');
          document.getElementById(`code-preview-${tab.dataset.tab}`).classList.add('active');
        });
      });

      function updatePreview() {
        const html = htmlInput.value;
        const css = `<style>${cssInput.value}</style>`;
        const js = `<script>${jsInput.value}<\/script>`;
        const fullDoc = `${html}\n${css}\n${js}`;
        preview.srcdoc = fullDoc;
      }

      htmlInput.addEventListener('input', updatePreview);
      cssInput.addEventListener('input', updatePreview);
      jsInput.addEventListener('input', updatePreview);
      window.addEventListener('DOMContentLoaded', updatePreview);
    </script>
  </body>
</html>
