<!DOCTYPE html>
<html class="dark" lang="<%= lang %>">
  <%- include('partials/head') %>
  <link rel="stylesheet" href="/assets/css/index.css" />

  <body class="light">
    <%- include('partials/header') %>

    <div id="preloader">
      <div class="spinner"></div>
    </div>

    <div class="full-layout">
      <div class="main-layout">
        <div class="main-panel">

          <!-- ✅ 코드 에디터 -->
          <section class="editor-section">
            <h2>✍️ HTML/CSS 코드 입력</h2>
            <textarea id="code-input" placeholder="여기에 HTML과 CSS 코드를 입력하세요. 예: <style>...</style> + <div>...</div>"></textarea>
          </section>

          <!-- ✅ 코드 미리보기 -->
          <section class="preview-section">
            <h2>🔎 미리보기</h2>
            <iframe id="code-preview" sandbox="allow-same-origin allow-scripts" frameborder="0"></iframe>
          </section>

        </div>
      </div>
    </div>

    <%- include('partials/scripts') %>

    <style>
      .editor-section, .preview-section {
        width: 90%;
        max-width: 1000px;
        margin: 40px auto;
        z-index: 10;
        position: relative;
      }

      .editor-section textarea {
        width: 100%;
        height: 300px;
        padding: 15px;
        font-family: monospace;
        font-size: 0.95rem;
        background: #1e1e1e;
        color: #f8f8f2;
        border: 1px solid #444;
        border-radius: 10px;
        resize: vertical;
      }

      .preview-section iframe {
        width: 100%;
        height: 400px;
        border: 1px solid #999;
        border-radius: 10px;
        background: white;
      }

      /* 캔버스가 입력창 위로 올라오지 못하게 함 */
      #matrix-canvas {
        z-index: -1 !important;
        pointer-events: none;
      }
    </style>

    <script>
      document.addEventListener('DOMContentLoaded', () => {
        const textarea = document.getElementById('code-input');
        const preview = document.getElementById('code-preview');

        textarea.addEventListener('input', () => {
          const content = textarea.value;
          const doc = `
            <!DOCTYPE html>
            <html>
              <head><meta charset="UTF-8"></head>
              <body>${content}</body>
            </html>
          `;
          preview.srcdoc = doc;
        });
      });
    </script>
  </body>
</html>
