<div class="header-top site-header">
  <% if (currentPath === '/' || currentPath === '/index') { %>
    <button class="hamburger" id="hamburger-btn" aria-label="메뉴 열기/닫기">
      <span></span>
      <span></span>
      <span></span>
    </button>
  <% } %>

  <nav class="nav-left">
    <div class="spotlight-wrapper">
      <img src="/assets/images/spotlight_left.svg" class="spotlight spotlight-left" alt="Spotlight Left" />
      <div class="light-beam beam-left"></div>
    </div>
    <ul class="nav-links">
      <li><a href="#">About</a></li>
      <li><a href="#">Lessons</a></li>
      <li><a href="#">Videos</a></li>
    </ul>
    <div class="social-icons">
      <a href="https://facebook.com" target="_blank"><i class="fab fa-facebook-f"></i></a>
      <a href="https://instagram.com" target="_blank"><i class="fab fa-instagram"></i></a>
      <a href="https://naver.com" target="_blank"><i class="fa-solid fa-n"></i></a>
      <a href="https://tiktok.com" target="_blank"><i class="fab fa-tiktok"></i></a>
    </div>
  </nav>

  <div class="logo-wrapper">
    <a href="/" class="logo-link">
      <img src="/assets/images/logo.svg" alt="로고" class="logo-img" />
    </a>
  </div>

  <nav class="nav-right">
    <ul class="nav-links">
      <li><a href="#">Sheet Music</a></li>
      <li><a href="#">Contact</a></li>
    </ul>
    <div class="spotlight-wrapper">
      <div class="light-beam beam-right"></div>
      <img src="/assets/images/spotlight_right.svg" class="spotlight spotlight-right" alt="Spotlight Right" />
    </div>

    <div class="auth-buttons">
      <% if (user) { %>
        <% if (Number(user.is_admin) === 1) { %>
          <span class="welcome-text"><strong><%= user.nickname %></strong>님 안녕하세요!</span>
          <a href="/write" class="auth-btn write-post"><i class="fas fa-pen"></i> 글쓰기</a>
        <% } %>
        <a href="/logout" class="auth-btn logout">로그아웃</a>
      <% } else { %>
        <a class="auth-btn signup" onclick="delayNavigation(event, '/signup')">회원가입</a>
        <button class="auth-btn login" id="login" type="button">로그인</button>
      <% } %>
    </div>

    <div class="light-switch" role="switch" aria-checked="false" aria-label="다크 모드 전환" tabindex="0" id="mode-toggle-accessible">
      <span class="switch-label"><span class="switch-handle"></span></span>
    </div>
  </nav>
</div>

<script>
  document.addEventListener('mousemove', (e) => {
    const mouseY = e.clientY;

    const spotlightLeft = document.querySelector('.spotlight-left');
    const beamLeft = document.querySelector('.beam-left');
    const spotlightRight = document.querySelector('.spotlight-right');
    const beamRight = document.querySelector('.beam-right');

    if (!spotlightLeft || !beamLeft || !spotlightRight || !beamRight) return;

    const lightY = spotlightLeft.getBoundingClientRect().bottom;
    const dy = mouseY - lightY;

    const angleRad = Math.atan2(dy, 100);
    const angleDeg = angleRad * (180 / Math.PI);

    const offset = -110;

    let leftAngle = angleDeg + offset;
    let rightAngle = angleDeg + offset;

    leftAngle = Math.max(-100, Math.min(-10, leftAngle));
    rightAngle = Math.max(-100, Math.min(-10, rightAngle));

    spotlightLeft.style.transform = `rotate(${leftAngle}deg)`;
    beamLeft.style.transform = `rotate(${leftAngle}deg)`;

    spotlightRight.style.transform = `scaleX(-1) rotate(${rightAngle}deg)`;
    beamRight.style.transform = `scaleX(-1) rotate(${rightAngle}deg)`;
  });
</script>
